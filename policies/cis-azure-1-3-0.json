{
  "name": "CIS Microsoft Azure Foundations Benchmark",
  "slug": "cis-azure-1-3-0",
  "body": "## Statement\n\nThis document, CIS Microsoft Azure Foundations Security Benchmark, provides prescriptive guidance for establishing a secure baseline configuration for Microsoft Azure. The scope of this benchmark is to establish the foundation level of security for anyone adopting Microsoft Azure Cloud. The benchmark is, however, not an exhaustive list of all possible security configurations and architecture. You should take the benchmark as a starting point and do the required site-specific tailoring wherever needed and when it is prudent to do so.\n\n### Intended Audience\n\nThis document is intended for system and application administrators, security specialists, auditors, help desk, and platform deployment personnel who plan to develop, deploy, assess, or secure solutions that incorporate Microsoft Azure.\n\nThe Audit and Remediation sections within this Benchmark have been refined to include the Azure console steps and Azure CLI 2.0 commands where applicable.\n\n### Assessment Status\n\nAn assessment status is included for every recommendation. The assessment status indicates whether the given recommendation can be automated or requires manual steps to implement. Both statuses are equally important and are determined and supported as defined below:\n\n- **Automated**\n\n    Represents recommendations for which assessment of a technical control can be fully automated and validated to a pass/fail state. Recommendations will include the necessary information to implement automation.\n\n- **Manual**\n\n    Represents recommendations for which assessment of a technical control cannot be fully automated and requires all or some manual steps to validate that the configured state is set as expected. The expected state can vary depending on the environment.\n\n## Recommendations\n\n<Procedure slug=\"cis-azure-1-3-0-iam\"/>\n<Procedure slug=\"cis-azure-1-3-0-sc\"/>\n<Procedure slug=\"cis-azure-1-3-0-storage\"/>\n<Procedure slug=\"cis-azure-1-3-0-db\"/>\n<Procedure slug=\"cis-azure-1-3-0-logging\"/>\n<Procedure slug=\"cis-azure-1-3-0-vm\"/>\n<Procedure slug=\"cis-azure-1-3-0-other\"/>\n<Procedure slug=\"cis-azure-1-3-0-appservice\"/>",
  "version": "1.3.0",
  "isStandard": true,
  "enabled": true,
  "procedures": [
    {
      "name": "1. Identity and Access Management",
      "slug": "cis-azure-1-3-0-iam",
      "body": "",
      "controls": [
        {
          "control": "azure-1-3-0-iam-1"
        },
        {
          "control": "azure-1-3-0-iam-2"
        },
        {
          "control": "azure-1-3-0-iam-4"
        },
        {
          "control": "entra-min-number-of-methods-for-sspr"
        },
        {
          "control": "entra-number-of-days-before-reconfirm-auth-info"
        },
        {
          "control": "entra-notify-users-on-password-reset"
        },
        {
          "control": "entra-notify-admins-on-admin-password-resets"
        },
        {
          "control": "entra-do-not-allow-user-consent"
        },
        {
          "control": "entra-user-consent-verified-publishers"
        },
        {
          "control": "entra-user-app-registration"
        },
        {
          "control": "entra-guest-users-access-restrictions"
        },
        {
          "control": "entra-guest-invite-restrictions"
        },
        {
          "control": "entra-restrict-access-to-admin-center"
        },
        {
          "control": "entra-restrict-access-to-groups-in-access-pane"
        },
        {
          "control": "azure-1-3-0-iam-17"
        },
        {
          "control": "azure-1-3-0-iam-18"
        },
        {
          "control": "azure-1-3-0-iam-19"
        },
        {
          "control": "azure-1-3-0-iam-20"
        },
        {
          "control": "azure-1-3-0-iam-21"
        },
        {
          "control": "azure-admin-resource-locks"
        }
      ]
    },
    {
      "name": "2. Security Center",
      "slug": "cis-azure-1-3-0-sc",
      "body": "",
      "controls": [
        {
          "control": "azure-defender-for-servers"
        },
        {
          "control": "azure-defender-for-app-services"
        },
        {
          "control": "azure-defender-for-sql-servers"
        },
        {
          "control": "azure-defender-for-sql-servers-on-machines"
        },
        {
          "control": "azure-defender-for-storage"
        },
        {
          "control": "azure-1-3-0-sc-6"
        },
        {
          "control": "azure-defender-for-containers"
        },
        {
          "control": "azure-defender-for-key-vault"
        },
        {
          "control": "azure-defender-endpoint-selected"
        },
        {
          "control": "azure-defender-cloud-apps-selected"
        },
        {
          "control": "azure-auto-provisioning-log-analystics"
        },
        {
          "control": "azure-additional-email-address"
        },
        {
          "control": "azure-notify-alerts-high-severity"
        },
        {
          "control": "azure-security-alert-emails-owners"
        }
      ]
    },
    {
      "name": "3. Storage Accounts",
      "slug": "cis-azure-1-3-0-storage",
      "body": "",
      "controls": [
        {
          "control": "azure-https-transfer-enabled"
        },
        {
          "control": "azure-1-3-0-storage-2"
        },
        {
          "control": "azure-log-queue-read-write-delete"
        },
        {
          "control": "azure-1-3-0-storage-4"
        },
        {
          "control": "object-containers-with-public-access"
        },
        {
          "control": "azure-deny-access-storage-account"
        },
        {
          "control": "azure-trusted-services-storage-account"
        },
        {
          "control": "azure-soft-delete-containers-blobs"
        },
        {
          "control": "azure-storage-encryption-cmk"
        },
        {
          "control": "azure-log-blob-read-write-delete"
        },
        {
          "control": "azure-1-3-0-storage-11"
        }
      ]
    },
    {
      "name": "4. Database Services",
      "slug": "cis-azure-1-3-0-db",
      "body": "",
      "controls": [
        {
          "control": "azure-auditing-on"
        },
        {
          "control": "azure-encryption-on-sql-database"
        },
        {
          "control": "azure-auditing-retention-greater-90"
        },
        {
          "control": "azure-1-3-0-database-2-1"
        },
        {
          "control": "azure-1-3-0-database-2-2"
        },
        {
          "control": "azure-1-3-0-database-2-3"
        },
        {
          "control": "azure-1-3-0-database-2-4"
        },
        {
          "control": "azure-1-3-0-database-2-5"
        },
        {
          "control": "azure-ssl-enabled-postgresql-server"
        },
        {
          "control": "azure-ssl-enabled-mysql-server"
        },
        {
          "control": "azure-log-checkpoints-postgresql-server"
        },
        {
          "control": "azure-log-connections-postgresql-server"
        },
        {
          "control": "azure-log-disconnections-postgresql-server"
        },
        {
          "control": "azure-connection-throttling-postgresql-server"
        },
        {
          "control": "azure-log-retention-days-postgresql-server"
        },
        {
          "control": "azure-allow-azure-services-postgresql-server"
        },
        {
          "control": "azure-ad-admin-sql-servers"
        },
        {
          "control": "azure-sql-server-tde-cmk-encryption"
        }
      ]
    },
    {
      "name": "5. Logging and Monitoring",
      "slug": "cis-azure-1-3-0-logging",
      "body": "",
      "controls": [
        {
          "control": "azure-1-3-0-logging-1-1"
        },
        {
          "control": "azure-diagnostic-settings-categories"
        },
        {
          "control": "azure-1-3-0-logging-1-3"
        },
        {
          "control": "azure-1-3-0-logging-1-4"
        },
        {
          "control": "azure-key-vault-logging-enabled"
        },
        {
          "control": "azure-alert-create-policy"
        },
        {
          "control": "azure-alert-delete-policy-assign"
        },
        {
          "control": "azure-alert-create-update-nsg"
        },
        {
          "control": "azure-alert-delete-nsg"
        },
        {
          "control": "azure-1-3-0-logging-2-5"
        },
        {
          "control": "azure-1-3-0-logging-2-6"
        },
        {
          "control": "azure-alert-create-update-sec-solution"
        },
        {
          "control": "azure-alert-delete-sec-solution"
        },
        {
          "control": "azure-1-3-0-logging-2-9"
        },
        {
          "control": "azure-1-3-0-logging-3"
        }
      ]
    },
    {
      "name": "6. Networing",
      "slug": "cis-azure-1-3-0-networking",
      "body": "",
      "controls": [
        {
          "control": "management-ports-restricted-from-internet"
        },
        {
          "control": "azure-sql-db-disallow-any-ip"
        },
        {
          "control": "azure-1-3-0-networking-4"
        },
        {
          "control": "azure-network-watcher-enabled"
        },
        {
          "control": "azure-restrict-udp"
        }
      ]
    },
    {
      "name": "7. Virtual Machines",
      "slug": "cis-azure-1-3-0-vm",
      "body": "",
      "controls": [
        {
          "control": "azure-vm-disks-managed"
        },
        {
          "control": "azure-vm-disks-cmk"
        },
        {
          "control": "azure-unattached-disks-enc-cmk"
        },
        {
          "control": "azure-1-3-0-vm-4"
        },
        {
          "control": "azure-1-3-0-vm-5"
        },
        {
          "control": "azure-1-3-0-vm-6"
        },
        {
          "control": "azure-1-3-0-vm-7"
        }
      ]
    },
    {
      "name": "8. Other Security Considerations",
      "slug": "cis-azure-1-3-0-other",
      "body": "",
      "controls": [
        {
          "control": "azure-expiration-keys-key-vault"
        },
        {
          "control": "azure-expiration-secrets-key-vault"
        },
        {
          "control": "azure-1-3-0-security-3"
        },
        {
          "control": "azure-key-vault-recoverable"
        },
        {
          "control": "azure-rbac-kubernetes"
        }
      ]
    },
    {
      "name": "9. AppService",
      "slug": "cis-azure-1-3-0-appservice",
      "body": "",
      "controls": [
        {
          "control": "app-service-auth-azure-apps"
        },
        {
          "control": "azure-redirect-http-to-https"
        },
        {
          "control": "azure-latest-tls-version"
        },
        {
          "control": "azure-client-certs-web-app"
        },
        {
          "control": "azure-register-aad-app-service"
        },
        {
          "control": "azure-latest-php-version"
        },
        {
          "control": "azure-latest-python-version"
        },
        {
          "control": "azure-latest-java-version"
        },
        {
          "control": "azure-http-latest-version-web-app"
        },
        {
          "control": "azure-ftp-deployments-disabled"
        },
        {
          "control": "azure-key-vaults-store-secrets"
        }
      ]
    }
  ],
  "targetCloudProviders": ["azure"]
}
