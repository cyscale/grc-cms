{"name":"Ensure that 'Data encryption' is set to 'On' on a SQL Database","slug":"azure-1-3-0-database-1-2","body":"Enable Transparent Data Encryption on every SQL server.\n\n**Rationale**\n\nAzure SQL Database transparent data encryption helps protect against the threat of malicious activity by performing real-time encryption and decryption of the database, associated backups, and transaction log files at rest without requiring changes to the application.","description":"","severity":3,"remediationDescription":"**From Azure Console**\n\n1. Go to `SQL databases`\n2. For each DB instance\n3. Click on `Transparent data encryption`\n4. Set `Data encryption` to `On`\n\n**Using Azure Command Line Interface 2.0**\n\nUse the below command to enable `Transparent data encryption` for SQL DB instance.\n\n```bash\naz sql db tde set --resource-group \u003cresourceGroup\u003e --server \u003cdbServerName\u003e --database \u003cdbName\u003e --status Enabled\n```\n\n**Note**\n\n- TDE cannot be used to encrypt the logical master database in SQL Database. The master database contains objects that are needed to perform the TDE operations on the user databases.\n- Azure Portal does not show master databases per SQL server. However, CLI/API responses will show master databases.\n\n**Default Value**\n\nBy default, `Data encryption` is set to `On`.\n\n**References**:\n\n1. [https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-with-azure-sql-database](https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-with-azure-sql-database)\n2. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-data-protection#dp-5-encrypt-sensitive-data-at-rest](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-data-protection#dp-5-encrypt-sensitive-data-at-rest)\n\n**Additional Information**\n\n- Transparent Data Encryption (TDE) can be enabled or disabled on individual `SQL Database` level and not on the `SQL Server` level.\n- TDE cannot be used to encrypt the logical master database in SQL Database. The master database contains objects that are needed to perform the TDE operations on the user databases","rules":[{"cloudProviders":["azure"],"comparator":"eq","expectedResult":"[]","subjects":["SQLDatabase"],"query":"azure-1-3-0-database-1-2-data-encryption-is-set-to-on-on-a-sql-database","returnPath":""}]}