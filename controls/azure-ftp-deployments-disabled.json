{
  "alertForSecondaryOnly": false,
  "name": "Ensure FTP deployments are disabled",
  "body": "By default, Azure Functions, Web and API Services can be deployed over FTP. If FTP is required for an essential deployment workflow, FTPS should be required for FTP login for all App Service Apps and Functions.\n\n**Rationale**\n\nAzure FTP deployment endpoints are public. An attacker listening to traffic on a Wi-Fi network used by a remote employee or a corporate network could see login traffic in clear-text which would then grant them full control of the code base of the app or service. This finding is more severe if User Credentials for deployment are set at the subscription level rather than using the default Application Credentials which are unique per App.\n\n**Impact**\n\nAny deployment workflows that rely on FTP or FTPs rather than the WebDeploy or HTTPs endpoints may be affected.",
  "slug": "azure-ftp-deployments-disabled",
  "remediationDescription": "**From Azure Console**\n\n1. Go to `App Services`\n2. For each app, under `Settings`, go to `Configuration`\n3. Under `General settings`, under the `Platform settings` header, set the `FTP state` to `Disabled` or `FTPS Only`\n\n**Using Azure Command Line Interface**\n\nYou can change the FTP state to `disabled` for `FtpsOnly`, as appropriate:\n\n```bash\naz webapp config set --resource-group <resourceGroup> --name <applicationName> --ftps-state [disabled|FtpsOnly]\n```\n\n**Using Azure PowerShell**\n\n```powershell\nSet-AzWebApp -ResourceGroupName <resourceGroup> -Name <applicationName> -FtpsState <Disabled/FtpsOnly>\n```\n\n**Default Value**\n\nBy default, the `FTP state` is `All allowed`.\n\n**References**\n\n1. [Azure Web Service Deploy via FTP](https://docs.microsoft.com/en-us/azure/app-service/deploy-ftp)\n2. [Azure Web Service Deployment](https://docs.microsoft.com/en-us/azure/app-service/overview-security)\n3. [https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-4-encrypt-sensitive-information-in-transit](https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-4-encrypt-sensitive-information-in-transit)\n4. [https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-posture-vulnerability-management#pv-7-rapidly-and-automatically-remediate-software-vulnerabilities](https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-posture-vulnerability-management#pv-7-rapidly-and-automatically-remediate-software-vulnerabilities)",
  "severity": 3
}