{"name":"Ensure routing tables for VPC peering are \"least access\"","slug":"aws-1-4-0-networking-4","body":"Once a VPC peering connection is established, routing tables must be updated to establish any connections between the peered VPCs. These routes can be as specific as desired - even peering a VPC to only a single host on the other side of the connection.","description":"","severity":2,"remediationDescription":"Remove and add route table entries to ensure that the least number of subnets or hosts as is required to accomplish the purpose for peering are routable.\n\n**From Command Line**\n\n1. For each \u003croute_table_id\u003e containing routes non compliant with your routing policy (which grants more than desired \"least access\"), delete the non compliant route:\n\n```bash\naws ec2 delete-route --route-table-id \u003croute_table_id\u003e --destination-cidr-block \u003cnon_compliant_destination_CIDR\u003e```\n2. Create a new compliant route:\n\n```bash\nnaws ec2 create-route --route-table-id \u003croute_table_id\u003e --destination-cidr-block \u003ccompliant_destination_CIDR\u003e --vpc-peering-connection-id \u003cpeering_connection_id\u003e```\n","rules":null}