{"name":"Ensure that there are only GCP-managed service account keys for each service account","slug":"gcp-iam-2","body":"User managed service account should not have user managed keys.\n\n**Rationale**\n\nAnyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.\n\nFor user-managed keys, user have to take ownership of key management activities which includes:\n\n- Key storage\n- Key distribution\n- Key revocation\n- Key rotation\n- Protecting the keys from unauthorized users\n- Key recovery\n\nEven after owner's precaution, keys can be easily leaked by common development malpractices like checking keys into the source code or leaving them in Downloads directory, or accidentally leaving them on support blogs/channels.\n\nIt is recommended to prevent use of User-managed service account keys.\n","description":"","severity":2,"remediationDescription":"Follow the documentation and setup corporate login accounts.\n\n**Impact**\n\nNone.\n\n**Default Value**\n\nBy default, any Gmail account can be associated with a Google Cloud Platform Project.\n\n**References**\n\n1. https://cloud.google.com/docs/enterprise/best-practices-for-enterprise-organizations#use_corporate_login_credentials\n2. https://support.google.com/work/android/answer/6371476","rules":[{"cloudProviders":["gcp"],"comparator":"eq","expectedResult":"[]","subjects":["IAMServiceAccount"],"query":"gcp-iam-2-there-are-only-gcp-managed-service-account-keys-for-each-service-account","returnPath":""}]}