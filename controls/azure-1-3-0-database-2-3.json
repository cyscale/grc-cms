{"name":"Ensure that VA setting 'Periodic Recurring Scans' is enabled on a SQL server","slug":"azure-1-3-0-database-2-3","body":"Enable Vulnerability Assessment (VA) Periodic recurring scans for critical SQL servers and corresponding SQL databases.\n\n**Rationale**\n\nVA setting 'Periodic recurring scans' schedules periodic (weekly) vulnerability scanning for the SQL server and corresponding Databases. Periodic and regular vulnerability scanning provides risk visibility based on updated known vulnerability signatures and best practices.\n\n**Impact**\n\nEnabling the Azure Defender for SQLfeature will incur additional costs for each SQL server.","description":"","severity":2,"remediationDescription":"**From Azure Console**\n\n1. Go to `SQL servers`\n2. For each server instance\n3. Click on `Security Center`\n4. In Section `Vulnerability Assessment Settings`, set `Storage Account` if not already\n5. Toggle 'Periodic recurring scans' to `ON`.\n6. Click `Save`\n\n**Using Azure PowerShell**\n\nIf not already, Enable Advanced Data Securityfor a SQL Server:\n\n\u003e`Set-AZSqlServerThreatDetectionPolicy -ResourceGroupName \\\u003cresource group name\\\u003e -ServerName \\\u003cserver name\\\u003e -EmailAdmins $True`\n\nTo enable ADS-VA service with 'Periodic recurring scans'\n\n\u003e`Update-AzSqlServerVulnerabilityAssessmentSetting -ResourceGroupName \"\u003cresource group name\u003e\"`\n\u003e\n\u003e`-ServerName \"\u003cServer Name\u003e\"`\n\u003e\n\u003e`-StorageAccountName \"\u003cStorage Name from same subscription and same Location\u003e\" `\n\u003e\n\u003e`-ScanResultsContainerName \"vulnerability-assessment\" `\n\u003e\n\u003e`-RecurringScansInterval Weekly `\n\u003e\n\u003e`-EmailSubscriptionAdmins $true `\n\u003e\n\u003e`-NotificationEmail @(\"mail1@mail.com\" , \"mail2@mail.com\")`\n\n**Default Value**\n\nEnabling Azure Defender for SQL enables 'Periodic recurring scans' by default but does not configure the Storage account.\n\n**References**\n\n1. [https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment](https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment)\n2. [https://docs.microsoft.com/en-us/rest/api/sql/servervulnerabilityassessments/listbyserver](https://docs.microsoft.com/en-us/rest/api/sql/servervulnerabilityassessments/listbyserver)\n3. [https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Update-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0](https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Update-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0)\n4. [https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Get-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0](https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Get-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0)\n5. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-posture-vulnerability-management#pv-6-perform-software-vulnerability-assessments](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-posture-vulnerability-management#pv-6-perform-software-vulnerability-assessments)","rules":null}