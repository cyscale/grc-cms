{"name":"Ensure that 'Advanced Threat Protection (ATP)' on a SQL server is set to 'Enabled'","slug":"azure-1-3-0-database-2-1","body":"Enable \"Azure Defender for SQL\" on critical SQLServers.\n\n**Rationale**\n\nAzure Defender for SQL is a unified package for advanced SQL security capabilities. Azure Defender is available for Azure SQL Database, Azure SQL Managed Instance, and Azure Synapse Analytics. It includes functionality for discovering and classifying sensitive data, surfacing and mitigating potential database vulnerabilities, and detecting anomalous activities that could indicate a threat to your database. It provides a single go-to location for enabling and managing these capabilities.\n\n**Impact**\n\nAzure Defender for SQL is a paid feature and will incur additional cost for each SQL server.","description":"","severity":1,"remediationDescription":"**From Azure Console**\n\n1. Go to `SQL servers`\n2. For each server instance\n3. Click on `Azure Defender for SQL`\n4. Set `Azure Defender for SQL` to `On`\n\n**Using Azure PowerShell**\n\nEnable Advanced Data Security for a SQL Server:\n\n\u003e`Set-AzSqlServerThreatDetectionPolicy -ResourceGroupName \\\u003cresource group name\\\u003e -ServerName \\\u003cserver name\\\u003e -EmailAdmins $True`\n\nNote:\n\n- Enabling 'Azure Defender for SQL' from the Azure portal enables Threat Detection\n- Using Powershell command `Set-AzSqlServerThreatDetectionPolicy` enables `Azure Defender for SQL` for a SQL server\n\n\n**Default Value**\n\nBy default, Azure Defender for SQL is set to Off.\n\n**References**\n\n1. [https://docs.microsoft.com/en-us/azure/azure-sql/database/azure-defender-for-sql](https://docs.microsoft.com/en-us/azure/azure-sql/database/azure-defender-for-sql)\n2. [https://docs.microsoft.com/cs-cz/powershell/module/azurerm.sql/get-azurermsqlserverthreatdetectionpolicy?view=azurermps-5.2.0](https://docs.microsoft.com/cs-cz/powershell/module/azurerm.sql/get-azurermsqlserverthreatdetectionpolicy?view=azurermps-5.2.0)\n3. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-data-protection#dp-3-monitor-for-unauthorized-transfer-of-sensitive-data](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-data-protection#dp-3-monitor-for-unauthorized-transfer-of-sensitive-data)\n\n**Additional Information**\n\n- The feature 'Azure Defender for SQL' can be enabled only on SQL server and the same settings will be inherently applied to the SQL databases hosted on the SQL server.","rules":null}