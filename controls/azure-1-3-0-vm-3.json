{"name":"Ensure that 'Unattached disks' are encrypted with CMK","slug":"azure-1-3-0-vm-3","body":"Ensure that unattached disks in a subscription are encrypted with a Customer Managed Key (CMK).\n\n**Rationale**\n\nManaged disks are encrypted by default with Platform-managed keys. Using Customer-managed keys may provide an additional level of security or meet an organization's regulatory requirements. Encrypting managed disks ensures that its entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. Even if the disk is not attached to any of the VMs, there is always a risk where a compromised user account with administrative access to VM service can mount/attach these data disks which may lead to sensitive information disclosure and tampering.\n\n**Impact**\n\nEncryption is available only on Standard tier VMs. This might cost you more.Utilizing and maintaining Customer-managed keys will require additional work to created, protect, and rotate keys.","description":"","severity":2,"remediationDescription":"If data stored in the disk is no longer useful, refer to Azure documentation to delete unattached data disks at:\n\n\u003e`-https://docs.microsoft.com/en-us/rest/api/compute/disks/delete`\n\u003e`-https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-delete`\n\nIf data stored in the disk is important, To encrypt the disk refer azure documentation at:\n\n\u003e`-https://docs.microsoft.com/en-us/azure/virtual-machines/disks-enable-customer-managed-keys-portal`\n\u003e`-https://docs.microsoft.com/en-us/rest/api/compute/disks/update#encryptionsettings`\n\n**Default Value**\n\nBy default, managed disks are encrypted with a Platform-managed key.\n\n**References**\n\n1. [https://docs.microsoft.com/en-us/azure/security/fundamentals/azure-disk-encryption-vms-vmss](https://docs.microsoft.com/en-us/azure/security/fundamentals/azure-disk-encryption-vms-vmss)\n2. [https://docs.microsoft.com/en-us/azure/security-center/security-center-disk-encryption?toc=%2fazure%2fsecurity%2ftoc.json](https://docs.microsoft.com/en-us/azure/security-center/security-center-disk-encryption?toc=%2fazure%2fsecurity%2ftoc.json)\n3. [https://docs.microsoft.com/en-us/rest/api/compute/disks/delete](https://docs.microsoft.com/en-us/rest/api/compute/disks/delete)\n4. [https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-delete](https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-delete)\n5. [https://docs.microsoft.com/en-us/rest/api/compute/disks/update#encryptionsettings](https://docs.microsoft.com/en-us/rest/api/compute/disks/update#encryptionsettings)\n6. [https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-update](https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-update)\n7. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-data-protection#dp-5-encrypt-sensitive-data-at-rest](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-data-protection#dp-5-encrypt-sensitive-data-at-rest)","rules":[{"cloudProviders":["azure"],"comparator":"eq","expectedResult":"[]","subjects":["Disk"],"query":"azure-1-3-0-vm-3-unattached-disks-are-encrypted-with-cmk","returnPath":""}]}