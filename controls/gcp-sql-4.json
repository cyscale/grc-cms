{"name":"Ensure that MySql database instances do not allow root login from any Host","slug":"gcp-sql-4","body":"It is recommended that root access to a MySql Database Instance should be allowed only through specific white-listed trusted IPs.\n\n**Rationale**\n\nWhen root access is allowed for any host, any host from authorized networks can attempt to authenticate to a MySql Database Instance using administrative privileges. To minimize attack surface root access can explicitly allowed from only trusted IPs (Hosts) to support database related administrative tasks.","description":"","severity":1,"remediationDescription":"**Using Command-line**\n\nNote: We haven't come across any setting provided by Google cloud console or gcloud utility to update host for a root user. Below remediation uses MySQL client binary to set the host for root user. Similarly, for PostgreSQL instance:\n\n1. Login to MySql database instance from `authorized network`\n\u003e mysql connect -u root \\[INSTANCE_ADRESS\\]\n```\n2. Set host for root user\n\n```sql\nUPDATE MySql.user SET Host=\\[Host_name/IP\\] WHERE User='root';\n\n**Impact**\n\nOnly configured hosts will be able access MySQL database Instance with root privileges.\n\n**Default Value**\n\nBy default, `root` access to MySql Database Instance is allowed for any Host. \n\n**References**\n\n1. https://cloud.google.com/MySql/docs/MySql/create-manage-users\n\n**Notes**\n\nThis recommendation is only applicable to MySQL database Instances. As of now for PostgreSQL, google cloud console/gcloud utility does not offer any relevant setting/option.\n\nApart from default `root` if there are any other database users with administrative privileges, those should be considered for this recommendation as well.","rules":[{"cloudProviders":["gcp"],"comparator":"eq","expectedResult":"[]","subjects":["SQLUser"],"query":"gcp-sql-4-mysql-database-instances-do-not-allow-root-login-from-any-host","returnPath":""}]}