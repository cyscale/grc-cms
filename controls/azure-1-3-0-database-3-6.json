{"name":"Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server","slug":"azure-1-3-0-database-3-6","body":"Enable `connection_throttling` on `PostgreSQL Servers`.\n\n**Rationale**\n\nEnabling `connection_throttling` helps the PostgreSQL Database to `Set the verbosity of logged messages` which in turn generates query and error logs with respect to concurrent connections, that could lead to a successful Denial of Service (DoS) attack by exhausting connection resources. A system can also fail or be degraded by an overload of legitimate users. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.","description":"","severity":2,"remediationDescription":"**From Azure Console**\n\n1. Login to Azure Portal using https://portal.azure.com\n2. Go to `Azure Database` for `PostgreSQL server`\n3. For each database, click on `Server parameters`\n4. Search for `connection_throttling`.\n5. Click `ON` and save.\n\n**Using Azure Command Line Interface 2.0**\n\nUse the below command to update connection_throttling configuration.\n\n```bash\naz postgres server configuration set --resource-group \u003cresourceGroupName\u003e --server-name \u003cserverName\\\u003e --name connection_throttling --value on```\n\n**References**\n\n1. [https://docs.microsoft.com/en-us/rest/api/postgresql/configurations/listbyserver](https://docs.microsoft.com/en-us/rest/api/postgresql/configurations/listbyserver)\n2. [https://docs.microsoft.com/en-us/azure/postgresql/howto-configure-server-parameters-using-portal](https://docs.microsoft.com/en-us/azure/postgresql/howto-configure-server-parameters-using-portal)\n3. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-logging-threat-detection#lt-4-enable-logging-for-azure-resources](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-logging-threat-detection#lt-4-enable-logging-for-azure-resources)","rules":[{"cloudProviders":["azure"],"comparator":"eq","expectedResult":"[]","subjects":["PostgreSQLServer"],"query":"azure-1-3-0-database-3-6-server-parameter-connection-throttling-is-set-to-on-for-postgresql-database-server","returnPath":""}]}