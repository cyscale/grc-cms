{"name":"Ensure soft delete is enabled for Azure Storage","slug":"azure-1-3-0-storage-8","body":"The Azure Storage blobs contain data like ePHI, Financial, secret or personal. Erroneously modified or deleted accidentally by an application or other storage account user cause data loss or dataunavailability.\n\nIt is recommended the Azure Storage be made recoverable by enabling soft delete configuration. This is to save and recover data when blobs or blob snapshots are deleted.\n\n**Rationale**\n\nThere could be scenarios where users accidentally run delete commands on Azure Storage blobs or blob snapshot or attacker/malicious user does it deliberately to cause disruption. Deleting an Azure Storage blob leads to immediate data loss / non-accessible data.\n\nThere is a property of Azure Storage blob service tomake recoverable blobs.\n\n- **Soft Delete** \n\n    Enabling this configuration for azure storage ensures that even if blobs/data were deleted from the storage account, Blobs/data objects remain recoverable for a particular time which set in the \"Retention policies\" [Retention policies can be 7 days to 365 days].","description":"","severity":2,"remediationDescription":"**From Azure Console**\n\n1. Go to Storage Account\n2. For each Storage Account, navigate to `Data Protection`\n3. Select set soft delete enabled and enter a number of days you want to retain soft deleted data.\n\n**Using Azure Command-Line Interface 2.0**\n\nUpdate retention days in below command\n\n```bash\naz storage blob service-properties delete-policy update --days-retained \u003cRetentionDaysValue\u003e --account-name \u003cStorageAccountName\u003e --enable true\n```\n\n**Default Value**\n\nWhen new storage account is created, soft delete is by default disabled.\n\n**References**\n\n1. [https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete](https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete)","rules":[{"cloudProviders":["azure"],"comparator":"eq","expectedResult":"[]","subjects":["StorageAccount"],"query":"azure-1-3-0-storage-8-soft-delete-is-enabled-for-azure-storage","returnPath":""}]}