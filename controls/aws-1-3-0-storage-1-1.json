{"name":"Ensure all S3 buckets employ encryption-at-rest","slug":"aws-1-3-0-storage-1-1","body":"Amazon S3 provides multiple encryption options to protect data at rest. With default encryption, you can set the behavior for a S3 bucket so that all new objects are encrypted when they are stored in the bucket. The objects can be encrypted using server-side encryption with either Amazon S3-managed keys (SSE-S3) or customer master keys (CMKs) stored in AWS Key Management Service (AWS KMS) (SSE-KMS).\n\nEncrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.","description":"","severity":2,"remediationDescription":"**From Console**\n\n1. Open AW S3 console [S3](https://console.aws.amazon.com/s3/).\n2. In the buckets list, choose the **Name** of the bucket that you want.\n3. Go to **Properties** tab and choose **Edit** under **Default encryption**.\n4. Select **Enable** and either select `SSE-S3` or `SSE-KMS`.\n5. Click **Save changes**.\n6. Repeat for all the buckets in your AWS account lacking encryption.\n\n**From Command Line**\n\nRun either\n\n```bash\naws s3api put-bucket-encryption --bucket \u003cbucket name\u003e --server-side-encryption-configuration '{\"Rules\": [{\"ApplyServerSideEncryptionByDefault\":{\"SSEAlgorithm\": \"AES256\"}}]}'\n```\n\nor\n\n```bash\naws s3api put-bucket-encryption --bucket \u003cbucket name\u003e --server-side-encryption-configuration '{\"Rules\": [{\"ApplyServerSideEncryptionByDefault\": {\"SSEAlgorithm\": \"aws:kms\",\"KMSMasterKeyID\": \"aws/s3\"}}]}'\n```\n**Note**: The KMSMasterKeyID can be set to the master key of your choosing; aws/s3 is an AWS preconfigured default.","rules":[{"cloudProviders":["aws"],"comparator":"eq","expectedResult":"[]","subjects":["Bucket"],"query":"aws-1-3-0-storage-1-1-all-s3-buckets-employ-encryption-at-rest","returnPath":""}]}