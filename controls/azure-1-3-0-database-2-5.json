{"name":"Ensure that VA setting 'Also send email notifications to admins and subscription owners' is set for a SQL server","slug":"azure-1-3-0-database-2-5","body":"Enable Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners'.\n\n**Rationale**\n\nVA scan reports and alerts will be sent to admins and subscription owners by enabling setting 'Also send email notifications to admins and subscription owners'. This may help in reducing time required for identifying risks and taking corrective measures.\n\n**Impact**\n\nEnabling the Azure Defender for SQLfeatures will incur additional costs for each SQL server.","description":"","severity":1,"remediationDescription":"**From Azure Console**\n\n1. Go to `SQL servers`\n2. Select a server instance\n3. Click on `Security Center`\n4. Select `Configure` next to `Enabled at subscription-level`\n5. In Section `Vulnerability Assessment Settings`, configure `Storage Accounts` if not already\n6. Check/enable 'Also send email notifications to admins and subscription owners'\n7. Click `Save`\n\n**Using Azure PowerShell**\n\nIf not already, Enable Advanced Data Security for a SQL Server:\n\n\u003e`Set-AZSqlServerThreatDetectionPolicy -ResourceGroupName \u003cresource group name\u003e -ServerName \u003cserver name\u003e -EmailAdmins $True`\n\nTo enable ADS-VA service and Set 'Also send email notifications to admins and subscription owners'\n\n\u003e`Update-AzSqlServerVulnerabilityAssessmentSetting `\n\u003e\n\u003e`-ResourceGroupName \\\"\u003cresource group name\u003e\\\"`\n\u003e\n\u003e`-ServerName \"\\\u003cServer Name\\\u003e\"`\n\u003e\n\u003e`-StorageAccountName \"\\\u003cStorage Name from same subscription and same Location\\\u003e\" `\n\u003e\n\u003e`-ScanResultsContainerName \"vulnerability-assessment\" `\n\u003e\n\u003e`-RecurringScansInterval Weekly `\n\u003e\n\u003e`-EmailSubscriptionAdmins $true `\n\u003e\n\u003e`-NotificationEmail @(\"mail1@mail.com\" , \"mail2@mail.com\")`\n\n**Default Value**\n\nBy default, 'Also send email notifications to admins and subscription owners' is enabled.\n\nReferences:\n\n1. [https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment](https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment)\n2. [https://docs.microsoft.com/en-us/rest/api/sql/servervulnerabilityassessments/listbyserver](https://docs.microsoft.com/en-us/rest/api/sql/servervulnerabilityassessments/listbyserver)\n3. [https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Update-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0](https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Update-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0)\n4. [https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Get-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0](https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Get-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0)\n5. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-posture-vulnerability-management#pv-6-perform-software-vulnerability-assessments](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-posture-vulnerability-management#pv-6-perform-software-vulnerability-assessments)","rules":null}