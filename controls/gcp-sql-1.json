{"name":"Ensure that Cloud SQL database instances require all incoming connections to use SSL","slug":"gcp-sql-1","body":"It is recommended to enforce all incoming connections to SQL database instance to use SSL.\n\n**Rationale**\n\nSQL database connections if successfully trapped (MITM - Man In The Middle); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance. This recommendation is applicable for PostgreSQL, MySQL generation 1 and MySQL generation 2 Instances.","description":"","severity":2,"remediationDescription":"**Using Command-line**\n\nTo enforce SSL encryption for an Instance run command:\n\n```bash\ngcloud sql instances patch \\[INSTANCE_NAME\\] --require-ssl\n```\n\n*Note:*\n`RESTART` is required for type MySQL Generation 1 Instances (`backendType: FIRST_GEN`) to get this configuration in effect.\n\n**Impact**\n\nAfter enforcing SSL connection, existing client will not be able to communicate with SQL server unless configured with appropriate client-certificates to communicate to SQL database instance.\n\n**Default Value**\n\nBy default parameter `settings: ipConfiguration: requireSsl` is not set which is equivalent to `requireSsl:false`.\n\n**References**\n\n1. https://cloud.google.com/sql/docs/postgres/configure-ssl-instance\n\n**Notes**\n\nBy default Settings: ipConfiguration has no authorizedNetworks set/configured. In that case even if by default requireSsl is not set, which is equivalent to requireSsl:false there is no risk as instance cannot be accessed outside of the network unless authorizedNetworks are configured. However, If default for requireSsl is not updated to true any authorizedNetworks created later on will not enforce SSL only connection.","rules":[{"cloudProviders":["gcp"],"comparator":"eq","expectedResult":"[]","subjects":["CloudSQLInstance"],"query":"gcp-sql-1-cloud-sql-database-instances-require-all-incoming-connections-to-use-ssl","returnPath":""}]}