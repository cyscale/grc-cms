{
  "name": "Ensure the --encryption-provider-config argument is set as appropriate",
  "body": "Encrypt etcd key-value store.\n\n**Rationale**\n\netcd is a highly available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted at rest to avoid any disclosures.",
  "slug": "k8s-encryption-provider-config-argument",
  "severity": 3,
  "remediationDescription": "Follow the Kubernetes documentation and configure a `EncryptionConfig` file. Then, edit\nthe API server pod specification file `/etc/kubernetes/manifests/kube-apiserver.yaml`\non the master node and set the `--encryption-provider-config` parameter to the path\nof that file:\n\n```bash\n--encryption-provider-config=<pathToEncryptionConfigFile>\n```\n\n**Default Value**\n\nBy default, `--encryption-provider-config` is not set.\n\n**References**\n\n1. [https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)\n2. [https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/)\n3. [https://github.com/kubernetes/features/issues/92](https://github.com/kubernetes/features/issues/92)",
  "alertForSecondaryOnly": false,
  "isInsight": false,
  "rules": [
    {
      "cloudProviders": [
        "k8s"
      ],
      "comparator": "eq",
      "expectedResult": "[]",
      "subjects": [
        "KubernetesPod"
      ],
      "query": "query-k8s-api-server-token-auth-file"
    }
  ]
}