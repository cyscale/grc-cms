{"name":"Ensure default network access rule for Storage Accounts is set to deny","slug":"azure-1-3-0-storage-6","body":"Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access to selected networks, the default action must be changed.\n\n**Rationale**\n\nStorage accounts should be configured to deny access to traffic from all networks (including internet traffic). Access can be granted to traffic from specific Azure Virtual networks, allowing a secure network boundary forspecific applications to be built. Access can also be granted to public internet IP address ranges, to enable connections from specific internet or on-premises clients. When network rules are configured, only applications from allowed networks can access a storage account. When calling from an allowed network, applications continue to require proper authorization (a valid access key or SAS token) to access the storage account.","description":"","severity":3,"remediationDescription":"**From Azure Console**\n\n1. Go to `Storage Accounts`\n2. For each storage account, Click on the `Networking` blade.\n3. Click the `Firewalls and virtual networks` heading.\n4. Ensure that Allow access from `All networks` is not selected.\n5. Click `Save` to apply your changes.\n\n**Using Azure Command Line Interface 2.0**\n\nUse the below command to update `default-action` to `Deny`.\n\n```bash\naz storage account update --name \u003cStorageAccountName\u003e --resource-group \u003cresourceGroupName\u003e --default-action Deny\n```\n\n**References**\n\n1. [https://docs.microsoft.com/en-us/azure/storage/common/storage-network-security](https://docs.microsoft.com/en-us/azure/storage/common/storage-network-security)\n2. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-governance-strategy#gs-2-define-enterprise-segmentation-strategy](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-governance-strategy#gs-2-define-enterprise-segmentation-strategy)\n3. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-network-security#ns-1-implement-security-for-internal-traffic](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-network-security#ns-1-implement-security-for-internal-traffic)","rules":[{"cloudProviders":["azure"],"comparator":"eq","expectedResult":"[]","subjects":["StorageAccount"],"query":"azure-1-3-0-storage-6-default-network-access-rule-for-storage-accounts-is-set-to-deny","returnPath":""}]}