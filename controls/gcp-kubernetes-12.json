{"name":"Ensure Kubernetes Cluster is created with Client Certificate enabled","slug":"gcp-kubernetes-12","body":"A client certificate is a base64-encoded public certificate used by clients to authenticate to the cluster endpoint.\n\n**Rationale**\n\nIf you disable client certificate generation to create a cluster without a client certificate. You will still be able to authenticate to the cluster with basic auth or IAM. But basic auth allows a user to authenticate to the cluster with a username and password which are stored in plain text without any encryption and might lead brute force attacks.","description":"","severity":2,"remediationDescription":"**Using Console**\n\n1. Go to Kubernetes GCP Console by visiting\nhttps://console.cloud.google.com/kubernetes/list?\n2. Click on CREATE CLUSTER\n3. Choose required name/value for cluster fields\n4. Click on More\n5. Set Client certificate to Enabled\n6. Click on Create\n\n**Using Command Line**\n\nTo enable Network policy for an existing cluster, run the following command:\n\n```bash\ngcloud container clusters create \\[CLUSTER_NAME\\] --zone \\[COMPUTE_ZONE\\] --issue-client-certificate\n```\n\n**Impact**\n\nCluster create command will create a new cluster with Client certificate enabled, But already existing once are remains unchanged.\n\n**Default Value**\n\nBy default, the Client certificate is enabled when you create a new cluster.\n\n**References**\n\n1. https://cloud.google.com/sdk/gcloud/reference/container/clusters/create","rules":[{"cloudProviders":["gcp"],"comparator":"eq","expectedResult":"[]","subjects":["Cluster"],"query":"gcp-kubernetes-12-kubernetes-cluster-is-created-with-client-certificate-enabled","returnPath":""}]}