{"name":"Ensure the S3 bucket used to store CloudTrail logs is not publicly accessible","slug":"aws-logging-3","body":"CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy, or access control list (ACL), applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs.\n\n**Rationale**\n\nAllowing public access to CloudTrail log content may aid an adversary in identifying weaknesses in the affected account's use or configuration.","description":"","severity":3,"remediationDescription":"Perform the following to remove any public access that has been granted to the bucket via an ACL or S3 bucket policy:\n\n1. Go to Amazon S3 console at https://console.aws.amazon.com/s3/home\n2. Right-click on the bucket and click Properties\n3. In the `Properties` pane, click the `Permissions` tab.\n4. The tab shows a list of grants, one row per grant, in the bucket ACL. Each row\nidentifies the grantee and the permissions granted.\n5. Select the row that grants permission to `Everyone` or `Any Authenticated User`\n6. Uncheck all the permissions granted to `Everyone` or `Any Authenticated User` (click `x` to delete the row).\n7. Click `Save` to save the ACL.\n8. If the `Edit bucket policy` button is present, click it.\n9. Remove any `Statement` having an `Effect` set to `Allow` and a `Principal` set to \"\\*\" or {\"AWS\" : \"*\"}.\n\n**Default Value**\n\nBy default, S3 buckets are not publicly accessible\n\n**References**\n\n1. CCE-78915-6\n2. https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html","rules":[{"cloudProviders":["aws"],"comparator":"eq","expectedResult":"[]","subjects":["Bucket"],"query":"aws-logging-3-the-s3-bucket-used-to-store-cloudtrail-logs-is-not-publicly-accessible","returnPath":""}]}