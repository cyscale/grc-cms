{"name":"Ensure the storage container storing the activity logs is not publicly accessible","slug":"azure-1-3-0-logging-1-3","body":"The storage account container containing the activity log export should not be publicly accessible.\n\n**Rationale**\n\nAllowing public access to activity log content may aid an adversary in identifying weaknesses in the affected account's use or configuration.\n\n**Impact**\n\nConfiguring container Access policyto privatewill remove access from the container for everyone except owners of the storage account. Access policy needs to be set explicitly in order to allow access to other desired users.","description":"","severity":3,"remediationDescription":"**From Azure Console**\n\n1. Search for `Storage Accounts` to access Storage account blade\n2. Click on the storage account name\n3. In Section `Blob Service` click `Containers`. It will list all the containers in next blade\n4. Look for a record with container named as `insight-operational-logs`. Click ...from right most column to open `Context menu`\n5. Click `Access Policy` from `Context Menu` and set `Public Access Level` to `Private (no anonymous access)`\n\n**Using Azure Command Line Interface 2.0**\n\n```bash\naz storage container set-permission --name insights-operational-logs --account-name \u003cStorage Account Name\u003e--public-access off```\n\n**Default Value**\n\nBy default, public access is set to null (allowing only private access) for a container with activity log export.\n\n**References**\n\n1. [https://docs.microsoft.com/en-us/azure/storage/blobs/anonymous-read-access-configure](https://docs.microsoft.com/en-us/azure/storage/blobs/anonymous-read-access-configure)\n2. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-network-security#ns-1-implement-security-for-internal-traffic](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-network-security#ns-1-implement-security-for-internal-traffic)\n","rules":[{"cloudProviders":["azure"],"comparator":"eq","expectedResult":"[]","subjects":["LogProfile"],"query":"azure-1-3-0-logging-1-3-the-storage-container-storing-the-activity-logs-is-not-publicly-accessible","returnPath":""}]}