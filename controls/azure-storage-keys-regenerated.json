{
  "name": "Ensure that storage account access keys are periodically regenerated",
  "slug": "azure-storage-keys-regenerated",
  "body": "For increased security, regenerate storage account access keys periodically.\n\n**Rationale**\n\nWhen a storage account is created, Azure generates two 512-bit storage access keys, which are used for authentication when the storage account is accessed. Rotating these keys periodically ensures that any inadvertent access or exposure does not result in the compromise of the keys.\n\nCryptographic key rotation periods will vary depending on your organization's security requirements and the type of data which is being stored in the Storage Account. For example, PCI DSS mandates that cryptographic keys be replaced or rotated 'regularly,' and advises that keys for static data stores be rotated every 'few months.'\n\nFor the purposes of this recommendation, 90 days will prescribed for the reminder. Review and adjustment of the 90 day period is recommended, and may even be necessary. Your organization's security requirements should dictate the appropriate setting.\n\n**Impact**\n\nRegenerating access keys can affect services in Azure as well as the organization's applications that are dependent on the storage account. All clients that use the access key to access the storage account must be updated to use the new key.",
  "severity": 2,
  "remediationDescription": "**From Azure Console**\n\n1. Go to `Storage Accounts`\n2. For each storage account, under `Security + networking`, select the `Access keys` blade\n3. Select `Set rotation reminder`\n4. Check `Enable key rotation reminders`\n5. Customize the settings\n6. Click `Save`\n\nNOTE: this solution only provides notifications indicating that the key(s) should be rotated. Your keys will not be rotated automatically.\n\nTo rotate a key, select the `Rotate key` button next to it, and then select `Yes`.\n\n**Default Value**\n\nBy default, access keys are not regenerated periodically.\n\n**References**\n\n1. [https://docs.microsoft.com/en-us/azure/storage/common/storage-create-storage-account#regenerate-storage-access-keys](https://docs.microsoft.com/en-us/azure/storage/common/storage-create-storage-account#regenerate-storage-access-keys)\n2. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-1-protect-and-limit-highly-privileged-users](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-1-protect-and-limit-highly-privileged-users)\n3. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-2-restrict-administrative-access-to-business-critical-systems](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-privileged-access#pa-2-restrict-administrative-access-to-business-critical-systems)\n4. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-identity-management#im-2-manage-application-identities-securely-and-automatically](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-identity-management#im-2-manage-application-identities-securely-and-automatically)\n5. [https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-governance-strategy#gs-6-define-identity-and-privileged-access-strategy](https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-governance-strategy#gs-6-define-identity-and-privileged-access-strategy)\n6. [https://www.pcidssguide.com/pci-dss-key-rotation-requirements/](https://www.pcidssguide.com/pci-dss-key-rotation-requirements/)\n7. [https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf)",
  "rules": [
    {
      "cloudProviders": [
        "azure"
      ],
      "comparator": "eq",
      "expectedResult": "[]",
      "subjects": [
        "StorageAccount"
      ],
      "query": "azure-1-3-0-storage-2-storage-account-access-keys-are-periodically-regenerated"
    }
  ]
}