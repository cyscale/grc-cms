{
  "name": "Ensure Private Google Access is enabled for all subnetworks in a VPC Network",
  "slug": "gcp-networking-5",
  "body": "Private Google Access enables virtual machine instances on a subnet to reach Google APIs and services using an internal IP address rather than an external IP address. External IP addresses are routable and reachable over the Internet. Internal (private) IP addresses are internal to Google Cloud Platform and are not routable or reachable over the Internet. You can use Private Google Access to allow VMs without Internet access to reach Google APIs, services, and properties that are accessible over HTTP/HTTPS.\n\n**Rationale**\n\nVPC networks and subnetworks provide logically isolated and secure network partitions where you can launch GCP resources. When Private Google Access is enabled, VM instances in a subnet can reach the Google Cloud and Developer APIs and services without needing an external IP address. Instead, VMs can use their internal IP addresses to access Google managed services. Instances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.",
  "description": "",
  "severity": 2,
  "remediationDescription": "**Using Console**\n\n1. Go to VPC network GCP Console visiting\n`https://console.cloud.google.com/networking/networks/list`\n2. Click the name of a subnet, The `Subnet details` page is displayed\n3. Click on `EDIT` button\n4. Set Private Google access to `On`\n5. Click on `Save`\n\n**Impact**\n\nInstances with external IP addresses are not affected when you enable the ability to access Google services from internal IP addresses. These instances can still connect to Google APIs and managed services.\n\n**Default Value**\n\nBy default, Private Google access is set to `Off` when you create a new VPC network subnet.\n\n**References**\n\n1. https://cloud.google.com/vpc/docs/configure-private-google-access\n2. https://cloud.google.com/vpc/docs/private-google-access",
  "rules": [
    {
      "cloudProviders": [
        "gcp"
      ],
      "comparator": "eq",
      "expectedResult": "[]",
      "subjects": [
        "VPC"
      ],
      "query": "gcp-networking-5-private-google-access-is-enabled-for-all-subnetworks-in-a-vpc-network",
      "returnPath": ""
    }
  ],
  "alertForSecondaryOnly": false
}