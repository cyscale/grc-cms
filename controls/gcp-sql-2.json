{"name":"Ensure that Cloud SQL database instances are not open to the world","slug":"gcp-sql-2","body":"The database server should accept connections only from trusted Network(s)/IP(s) and restrict access from the world.\n\n**Rationale**\n\nTo minimize attack surface on a Database server Instance, only trusted/known and required IP(s) should be white-listed to connect to it.\nAuthorized network should not have IPs/networks configured to 0.0.0.0 or /0 which will allow access to the instance from anywhere in the world.","description":"","severity":3,"remediationDescription":"**Using Command-line**\n\nUpdate the authorized network list by dropping off any addresses\n\n```bash\ngcloud sql instances patch \\[INSTANCE_NAME\\] --authorized-networks=\\[IP_ADDR1\\],\\[IP_ADDR2\\]...\n```\n\n**Impact**\n\nThe Cloud SQL database instance would not be available to the world.\n\n**Default Value**\n\nBy default, authorized networks are not configured. Remote connection to Cloud SQL database instance is not possible unless authorized networks are configured.\n\n**References**\n\n1. https://cloud.google.com/sql/docs/postgres/configure-ip\n\n**Notes**\n\nThere is no IPv6 configuration found for Google cloud SQL server services.","rules":[{"cloudProviders":["gcp"],"comparator":"eq","expectedResult":"[]","subjects":["CloudSQLInstance"],"query":"gcp-sql-2-cloud-sql-database-instances-are-not-open-to-the-world","returnPath":""}]}