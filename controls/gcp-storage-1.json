{"name":"Ensure that Cloud Storage buckets are not anonymously or publicly accessible","slug":"gcp-storage-1","body":"It is recommended that IAM policy on Cloud Storage bucket does not allows anonymous and/or public access.\n\n**Rationale**\n\nAllowing anonymous and/or public access grants permissions to anyone to access bucket content. Such access might not be desired if you are storing any sensitive data. Hence, ensure that anonymous and/or public access to a bucket is not allowed.","description":"","severity":3,"remediationDescription":"**From Console**\n\n1. Go to the Google Cloud Portal\n2. Go to `Storage` Section\n3. In Storage, Click `Browser`\n4. Select each storage bucket and `click on menu` in right most column\n5. Select `Edit Bucket Permissions`\n6. Expand every role displayed.\n7. Click `Delete` button in front of `allUsers` and/or `allAuthenticatedUsers` to remove that particular role assignment\n\n**Impact**\n\nNo storage buckets would be publicly accessible. You would have to explicitly administer bucket access.\n\n**Default Value**\n\nBy Default, Storage buckets are not publicly shared.\n\n**References**\n\n1. https://cloud.google.com/storage/docs/access-control/iam-reference\n2. https://cloud.google.com/storage/docs/access-control/making-data-public\n\n**Notes**\n\nTo implement Access restrictions on buckets, configuring Bucket IAM is preferred way than configuring Bucket ACL. On GCP console, \"Edit Permissions\" for bucket exposes IAM configurations only. Bucket ACLs are configured automatically as per need in order to implement/support User enforced Bucket IAM policy. In-case administrator changes bucket ACL using command-line(gsutils)/API bucket IAM also gets updated automatically.","rules":[{"cloudProviders":["gcp"],"comparator":"eq","expectedResult":"[]","subjects":["Bucket"],"query":"gcp-storage-1-cloud-storage-buckets-are-not-anonymously-or-publicly-accessible","returnPath":""}]}