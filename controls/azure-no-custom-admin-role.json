{
  "alertForSecondaryOnly": false,
  "slug": "azure-no-custom-admin-role",
  "name": "Ensure that no custom administrator roles exist",
  "body": "The principle of least privilege should be followed and only necessary privileges should be assigned instead of allowing full administrative access.\n\n**Rationale**\n\nClassic subscription admin roles offer basic access management and include Account Administrator, Service Administrator, and Co-Administrators. It is recommended the least necessary permissions be given initially. Permissions can be added as needed by the account holder. This ensures the account holder cannot perform actions which were not intended.\n\n**Impact**\n\nSubscriptions will need to be handled by Administrators with permissions.",
  "severity": 1,
  "remediationDescription": "**From Azure Console**\n\n1. Go to `Subscriptions`\n2. For each subscription, select `Access control (IAM)`\n3. Select `Roles`\n4. Filter by `Type : CustomRole`\n5. For each role, check the box next to the role which grants subcription administrator privileges\n6. Select `Remove`\n7. Select `Yes`\n\n\n**Using Azure Command Line Interface**\n\nList custom roles\n\n```bash\naz role definition list --custom-role-only True\n```\n\nLook for entries with `assignableScope` of `/` or a `subscription`, and an action of `*`. To remove a violating role:\n\n```bash\naz role definition delete --name <rolename>\n```\n\nNote that any role assignments must be removed before a custom role can be deleted. \nEnsure that the impact is assessed before deleting a custom role granting subscription administrator privileges.\n\n**Default Value**\n\nBy default, no custom owner roles are created.\n\n**References**\n\n1. [https://docs.microsoft.com/en-us/azure/billing/billing-add-change-azure-subscription-administrator](https://docs.microsoft.com/en-us/azure/billing/billing-add-change-azure-subscription-administrator)\n2. [https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-governance-strategy#gs-2-define-enterprise-segmentation-strategy](https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-governance-strategy#gs-2-define-enterprise-segmentation-strategy)\n3. [https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-governance-strategy#gs-6-define-identity-and-privileged-access-strategy](https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-governance-strategy#gs-6-define-identity-and-privileged-access-strategy)\n4. [https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-privileged-access#pa-1-protect-and-limit-highly-privileged-users](https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-privileged-access#pa-1-protect-and-limit-highly-privileged-users)\n5. [https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-privileged-access#pa-5-automate-entitlement-management](https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-privileged-access#pa-5-automate-entitlement-management)\n6. [https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-privileged-access#pa-2-restrict-administrative-access-to-business-critical-systems](https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-privileged-access#pa-2-restrict-administrative-access-to-business-critical-systems)\n7. [https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-governance-strategy#gs-2-define-enterprise-segmentation-strategy](https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-governance-strategy#gs-2-define-enterprise-segmentation-strategy)\n8. [https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-governance-strategy#gs-6-define-identity-and-privileged-access-strategy](https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-governance-strategy#gs-6-define-identity-and-privileged-access-strategy)\n9. [https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle](https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle)",
  "rules": [
    {
      "cloudProviders": [
        "azure"
      ],
      "comparator": "eq",
      "expectedResult": "[]",
      "subjects": [
        "IAMCustomRole"
      ],
      "query": "azure-1-3-0-iam-21-no-custom-subscription-owner-roles-are-created"
    }
  ]
}