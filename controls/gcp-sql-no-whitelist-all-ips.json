{
  "alertForSecondaryOnly": false,
  "name": "Ensure Cloud SQL Database Instances Do Not Implicitly Whitelist All Public IP Addresses",
  "description": "Cloud SQL Instances Allowing All Traffic",
  "slug": "gcp-sql-no-whitelist-all-ips",
  "body": "Database Server should accept connections only from trusted Network(s)/IP(s) and restrict access from the world.\n\n#ï»¿## Rationale\n\n\r\n\r\nTo minimize attack surface on a Database server instance, only trusted/known and required IP(s) should be whitelisted to connect to it.\n\n\r\n\r\nAn authorized network should not have IPs/networks configured to `0.0.0.0/0` which will allow access to the instance from anywhere in the world. Note that authorized networks apply only to instances with public IPs.",
  "severity": 2,
  "remediationDescription": "### From Console\n\n\r\n\r\n1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting [https://console.cloud.google.com/sql/instances](https://console.cloud.google.com/sql/instances).\r\n2. Click the instance name to open its `Instance details` page.\r\n3. Under the `Configuration` section click `Edit configurations`\r\n4. Under `Configuration options` expand the `Connectivity` section.\r\n5. Click the `delete` icon for the authorized network `0.0.0.0/0`.\r\n6. Click `Save` to update the instance.\n\n\r\n\r\n### From Command Line\n\n\r\n\r\nUpdate the authorized network list by dropping off any addresses\r\n\r\n```bash\r\ngcloud sql instances patch INSTANCE_NAME --authorized-networks=IP_ADDR1,IP_ADDR2,...\r\n```\n\n\r\n\r\n### Prevention\n\n\r\n\r\nTo prevent new SQL instances from being configured to accept incoming connections from any IP addresses, set up a `Restrict Authorized Networks on Cloud SQL instances` Organization Policy at: [https://console.cloud.google.com/iam-admin/orgpolicies/sql-restrictAuthorizedNetworks](https://console.cloud.google.com/iam-admin/orgpolicies/sql-restrictAuthorizedNetworks).\n\n\r\n\r\n### Default Value\n\n\r\n\r\nBy default, authorized networks are not configured. Remote connection to Cloud SQL database instance is not possible unless authorized networks are configured.",
  "rules": []
}