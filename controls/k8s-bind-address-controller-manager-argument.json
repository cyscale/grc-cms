{
  "alertForSecondaryOnly": false,
  "isInsight": false,
  "name": "Ensure the --bind-address argument is set to 127.0.0.1",
  "slug": "k8s-bind-address-controller-manager-argument",
  "body": "Do not bind the Controller Manager service to non-loopback, insecure addresses.\n\n**Rationale**\n\nThe Controller Manager API service, which runs on port TCP 10252 by default, is used for health and metrics information and is available without authentication or encryption. As such, it should only be bound to a localhost interface, to minimize the cluster's attack surface.",
  "severity": 3,
  "remediationDescription": "Edit the Controller Manager pod specification file `/etc/kubernetes/manifests/kubecontroller-manager.yaml` on the Control Plane node and add the correct value for the `--bind-address parameter`.\n\n```bash\n--bind-address=127.0.0.1\n```\n\n**Default Value**\n\nBy default, the `--bind-address` parameter is set to `0.0.0.0`.\n\n**References**\n\n1. [https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/)\n\n**Additional Information**\n\nAlthough the current Kubernetes documentation site says that `--address` is deprecated in favour of `--bind-address`, Kubeadm 1.11 still makes use of `--address`.",
  "rules": [
    {
      "cloudProviders": [
        "k8s"
      ],
      "comparator": "eq",
      "expectedResult": "[]",
      "subjects": [
        "KubernetesPod"
      ],
      "query": "query-k8s-controller-manager-bind-address"
    }
  ]
}