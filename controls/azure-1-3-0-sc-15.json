{"name":"Ensure security alert emails for subscription owners are enabled","slug":"azure-1-3-0-sc-15","body":"Enable security alert emails to subscription owners.\n\n**Rationale**\n\nEnabling security alert emails to subscription owners ensures that they receive security alert emails from Microsoft. This ensures that they are aware of anypotential security issues and can mitigate the risk in a timely fashion.","description":"","severity":1,"remediationDescription":"**From Azure Console**\n\n1. Go to `Security Center`\n2. Click on `Pricing \u0026 settings`\n3. Click on the appropriate Management Group, Subscription, or Workspace\n4. Click on `Email notifications`\n5. In the drop down of the `All users with the following roles` field select `Owner`\n6. Click `Save`\n\n**Using Azure Command Line Interface 2.0**\n\nUse the below command to set Send email also to subscription owners to On.\n\n```bash\naz account get-access-token --query \"{subscription:subscription,accessToken:accessToken}\" --out tsv | xargs -L1 bash -c 'curl -X GET -H \"Authorization: Bearer $1\" -H \"Content-Type: application/json\" https://management.azure.com/subscriptions/$0/providers/Microsoft.Security/securityContacts?api-version=2020-01-01-preview' | jq '.|.value[] | select(.name==\"default\")'|jq '.properties.notificationsByRole'\n```\n\nWhere `input.json` contains the request body json data as mentioned below. And replace `validEmailAddress` with email ids csv for multiple.\n\n```json\n{\n    \"id\": \"/subscriptions/\u003cYour_Subscription_Id\u003e/providers/Microsoft.Security/securityContacts/default1\",\n    \"name\": \"default1\",\n    \"type\": \"Microsoft.Security/securityContacts\",\n    \"properties\": {\n        \"email\": \"\u003cvalidEmailAddress\u003e\",\n        \"alertNotifications\": \"On\",\n        \"alertsToAdmins\": \"On\"\n    }\n}\n```\n\n**Default Value**\n\nBy default, Owner is selected\n\n**References**\n\n1. [https://docs.microsoft.com/en-us/azure/security-center/security-center-provide-security-contact-details](https://docs.microsoft.com/en-us/azure/security-center/security-center-provide-security-contact-details)\n2. [https://docs.microsoft.com/en-us/rest/api/securitycenter/securitycontacts/list](https://docs.microsoft.com/en-us/rest/api/securitycenter/securitycontacts/list)\n3. [https://docs.microsoft.com/en-us/rest/api/securitycenter/securitycontacts/update](https://docs.microsoft.com/en-us/rest/api/securitycenter/securitycontacts/update)\n4. [https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-incident-response#ir-2-preparation--setup-incident-notification](https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-incident-response#ir-2-preparation--setup-incident-notification)\n\n**Additional Information**\n- Excluding any of the entries in recommendations block in input.json disables the specific setting by default","rules":[{"cloudProviders":["azure"],"comparator":"eq","expectedResult":"[]","subjects":["SecurityContact"],"query":"azure-1-3-0-sc-15-security-alert-emails-for-subscription-owners-are-enabled","returnPath":""}]}