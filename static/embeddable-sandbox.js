!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).EmbeddedSandbox=t()}(this,(function(){"use strict";const e=(e=!1)=>e?"https://embed.apollo.local:3000/sandbox/explorer":"https://sandbox.embed.apollographql.com/sandbox/explorer",t="SchemaError",n="SchemaResponse",r="ExplorerResponse",o="ExplorerSubscriptionResponse",i=e=>`apollo-embed-${e}`;var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(e){var t=e.default;if("function"==typeof t){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n}var c={removeLeadingAndTrailingHTTPWhitespace:e=>e.replace(/^[ \t\n\r]+/u,"").replace(/[ \t\n\r]+$/u,""),removeTrailingHTTPWhitespace:e=>e.replace(/[ \t\n\r]+$/u,""),isHTTPWhitespaceChar:e=>" "===e||"\t"===e||"\n"===e||"\r"===e,solelyContainsHTTPTokenCodePoints:e=>/^[-!#$%&'*+.^_`|~A-Za-z0-9]*$/u.test(e),soleyContainsHTTPQuotedStringTokenCodePoints:e=>/^[\t\u0020-\u007E\u0080-\u00FF]*$/u.test(e),asciiLowercase:e=>e.replace(/[A-Z]/gu,(e=>e.toLowerCase())),collectAnHTTPQuotedString:(e,t)=>{let n="";for(t++;;){for(;t<e.length&&'"'!==e[t]&&"\\"!==e[t];)n+=e[t],++t;if(t>=e.length)break;const r=e[t];if(++t,"\\"!==r)break;if(t>=e.length){n+="\\";break}n+=e[t],++t}return[n,t]}};const{asciiLowercase:l,solelyContainsHTTPTokenCodePoints:u,soleyContainsHTTPQuotedStringTokenCodePoints:p}=c;var d=class{constructor(e){this._map=e}get size(){return this._map.size}get(e){return e=l(String(e)),this._map.get(e)}has(e){return e=l(String(e)),this._map.has(e)}set(e,t){if(e=l(String(e)),t=String(t),!u(e))throw new Error(`Invalid MIME type parameter name "${e}": only HTTP token code points are valid.`);if(!p(t))throw new Error(`Invalid MIME type parameter value "${t}": only HTTP quoted-string token code points are valid.`);return this._map.set(e,t)}clear(){this._map.clear()}delete(e){return e=l(String(e)),this._map.delete(e)}forEach(e,t){this._map.forEach(e,t)}keys(){return this._map.keys()}values(){return this._map.values()}entries(){return this._map.entries()}[Symbol.iterator](){return this._map[Symbol.iterator]()}};const{removeLeadingAndTrailingHTTPWhitespace:f,removeTrailingHTTPWhitespace:h,isHTTPWhitespaceChar:m,solelyContainsHTTPTokenCodePoints:y,soleyContainsHTTPQuotedStringTokenCodePoints:b,asciiLowercase:v,collectAnHTTPQuotedString:g}=c,{solelyContainsHTTPTokenCodePoints:E}=c,T=d,{asciiLowercase:w,solelyContainsHTTPTokenCodePoints:I}=c;function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t,n){return t&&S(e.prototype,t),n&&S(e,n),e}var x=function(){return"function"==typeof Symbol},N=function(e){return x()&&Boolean(Symbol[e])},C=function(e){return N(e)?Symbol[e]:"@@"+e};x()&&!N("observable")&&(Symbol.observable=Symbol("observable"));var A=C("iterator"),k=C("observable"),P=C("species");function R(e,t){var n=e[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function j(e){var t=e.constructor;return void 0!==t&&null===(t=t[P])&&(t=void 0),void 0!==t?t:B}function M(e){return e instanceof B}function F(e){F.log?F.log(e):setTimeout((function(){throw e}))}function D(e){Promise.resolve().then((function(){try{e()}catch(e){F(e)}}))}function L(e){var t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{var n=R(t,"unsubscribe");n&&n.call(t)}}catch(e){F(e)}}function U(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function q(e,t,n){e._state="running";var r=e._observer;try{var o=R(r,t);switch(t){case"next":o&&o.call(r,n);break;case"error":if(U(e),!o)throw n;o.call(r,n);break;case"complete":U(e),o&&o.call(r)}}catch(e){F(e)}"closed"===e._state?L(e):"running"===e._state&&(e._state="ready")}function $(e,t,n){if("closed"!==e._state){if("buffering"!==e._state)return"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:n}],void D((function(){return function(e){var t=e._queue;if(t){e._queue=void 0,e._state="ready";for(var n=0;n<t.length&&(q(e,t[n].type,t[n].value),"closed"!==e._state);++n);}}(e)}))):void q(e,t,n);e._queue.push({type:t,value:n})}}var V,G,Q=function(){function e(e,t){this._cleanup=void 0,this._observer=e,this._queue=void 0,this._state="initializing";var n=new W(this);try{this._cleanup=t.call(void 0,n)}catch(e){n.error(e)}"initializing"===this._state&&(this._state="ready")}return e.prototype.unsubscribe=function(){"closed"!==this._state&&(U(this),L(this))},O(e,[{key:"closed",get:function(){return"closed"===this._state}}]),e}(),W=function(){function e(e){this._subscription=e}var t=e.prototype;return t.next=function(e){$(this._subscription,"next",e)},t.error=function(e){$(this._subscription,"error",e)},t.complete=function(){$(this._subscription,"complete")},O(e,[{key:"closed",get:function(){return"closed"===this._subscription._state}}]),e}(),B=function(){function e(t){if(!(this instanceof e))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}var t=e.prototype;return t.subscribe=function(e){return"object"==typeof e&&null!==e||(e={next:e,error:arguments[1],complete:arguments[2]}),new Q(e,this._subscriber)},t.forEach=function(e){var t=this;return new Promise((function(n,r){if("function"==typeof e)var o=t.subscribe({next:function(t){try{e(t,i)}catch(e){r(e),o.unsubscribe()}},error:r,complete:n});else r(new TypeError(e+" is not a function"));function i(){o.unsubscribe(),n()}}))},t.map=function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(j(this))((function(n){return t.subscribe({next:function(t){try{t=e(t)}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))},t.filter=function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(j(this))((function(n){return t.subscribe({next:function(t){try{if(!e(t))return}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))},t.reduce=function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=j(this),r=arguments.length>1,o=!1,i=arguments[1],s=i;return new n((function(n){return t.subscribe({next:function(t){var i=!o;if(o=!0,!i||r)try{s=e(s,t)}catch(e){return n.error(e)}else s=t},error:function(e){n.error(e)},complete:function(){if(!o&&!r)return n.error(new TypeError("Cannot reduce an empty sequence"));n.next(s),n.complete()}})}))},t.concat=function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=j(this);return new o((function(t){var r,i=0;return function e(s){r=s.subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){i===n.length?(r=void 0,t.complete()):e(o.from(n[i++]))}})}(e),function(){r&&(r.unsubscribe(),r=void 0)}}))},t.flatMap=function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=j(this);return new n((function(r){var o=[],i=t.subscribe({next:function(t){if(e)try{t=e(t)}catch(e){return r.error(e)}var i=n.from(t).subscribe({next:function(e){r.next(e)},error:function(e){r.error(e)},complete:function(){var e=o.indexOf(i);e>=0&&o.splice(e,1),s()}});o.push(i)},error:function(e){r.error(e)},complete:function(){s()}});function s(){i.closed&&0===o.length&&r.complete()}return function(){o.forEach((function(e){return e.unsubscribe()})),i.unsubscribe()}}))},t[k]=function(){return this},e.from=function(t){var n="function"==typeof this?this:e;if(null==t)throw new TypeError(t+" is not an object");var r=R(t,k);if(r){var o=r.call(t);if(Object(o)!==o)throw new TypeError(o+" is not an object");return M(o)&&o.constructor===n?o:new n((function(e){return o.subscribe(e)}))}if(N("iterator")&&(r=R(t,A)))return new n((function(e){D((function(){if(!e.closed){for(var n,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(r.call(t));!(n=o()).done;)if(e.next(n.value),e.closed)return;e.complete()}}))}));if(Array.isArray(t))return new n((function(e){D((function(){if(!e.closed){for(var n=0;n<t.length;++n)if(e.next(t[n]),e.closed)return;e.complete()}}))}));throw new TypeError(t+" is not observable")},e.of=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o="function"==typeof this?this:e;return new o((function(e){D((function(){if(!e.closed){for(var t=0;t<n.length;++t)if(e.next(n[t]),e.closed)return;e.complete()}}))}))},O(e,null,[{key:P,get:function(){return this}}]),e}();function J(e){const t=null!=e?e:{};return Object.keys(t).every((e=>"content-type"!==e.toLowerCase()))&&(t["content-type"]="application/json"),t}function H({message:e,embeddedIFrameElement:t,embedUrl:n}){var r;null===(r=null==t?void 0:t.contentWindow)||void 0===r||r.postMessage(e,n)}function z(e){return null===e?"null":Array.isArray(e)?"array":typeof e}function K(e){return"object"===z(e)}function Y(e,t){return e.length<124?e:t}function X(e){if(!K(e))throw new Error(`Message is expected to be an object, but got ${z(e)}`);if(!e.type)throw new Error("Message is missing the 'type' property");if("string"!=typeof e.type)throw new Error(`Message is expects the 'type' property to be a string, but got ${z(e.type)}`);switch(e.type){case G.ConnectionInit:case G.ConnectionAck:case G.Ping:case G.Pong:if("payload"in e&&!K(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object or missing, but got "${e.payload}"`);break;case G.Subscribe:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${z(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!K(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${z(e.payload)}`);if("string"!=typeof e.payload.query)throw new Error(`"${e.type}" message payload expects the 'query' property to be a string, but got ${z(e.payload.query)}`);if(null!=e.payload.variables&&!K(e.payload.variables))throw new Error(`"${e.type}" message payload expects the 'variables' property to be a an object or nullish or missing, but got ${z(e.payload.variables)}`);if(null!=e.payload.operationName&&"string"!==z(e.payload.operationName))throw new Error(`"${e.type}" message payload expects the 'operationName' property to be a string or nullish or missing, but got ${z(e.payload.operationName)}`);if(null!=e.payload.extensions&&!K(e.payload.extensions))throw new Error(`"${e.type}" message payload expects the 'extensions' property to be a an object or nullish or missing, but got ${z(e.payload.extensions)}`);break;case G.Next:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${z(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!K(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${z(e.payload)}`);break;case G.Error:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${z(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(t=e.payload,!(Array.isArray(t)&&t.length>0&&t.every((e=>"message"in e))))throw new Error(`"${e.type}" message expects the 'payload' property to be an array of GraphQL errors, but got ${JSON.stringify(e.payload)}`);break;case G.Complete:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${z(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);break;default:throw new Error(`Invalid message 'type' property "${e.type}"`)}var t;return e}function Z(e,t){return X(e),JSON.stringify(e,t)}function ee(e){return K(e)&&"code"in e&&"reason"in e}function te(e,t){if(!Boolean(e))throw new Error(t)}x()&&Object.defineProperty(B,Symbol("extensions"),{value:{symbol:k,hostReportError:F},configurable:!0}),function(e){e[e.InternalServerError=4500]="InternalServerError",e[e.InternalClientError=4005]="InternalClientError",e[e.BadRequest=4400]="BadRequest",e[e.BadResponse=4004]="BadResponse",e[e.Unauthorized=4401]="Unauthorized",e[e.Forbidden=4403]="Forbidden",e[e.SubprotocolNotAcceptable=4406]="SubprotocolNotAcceptable",e[e.ConnectionInitialisationTimeout=4408]="ConnectionInitialisationTimeout",e[e.ConnectionAcknowledgementTimeout=4504]="ConnectionAcknowledgementTimeout",e[e.SubscriberAlreadyExists=4409]="SubscriberAlreadyExists",e[e.TooManyInitialisationRequests=4429]="TooManyInitialisationRequests"}(V||(V={})),function(e){e.ConnectionInit="connection_init",e.ConnectionAck="connection_ack",e.Ping="ping",e.Pong="pong",e.Subscribe="subscribe",e.Next="next",e.Error="error",e.Complete="complete"}(G||(G={}));const ne={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},re=new Set(Object.keys(ne));function oe(e){const t=null==e?void 0:e.kind;return"string"==typeof t&&re.has(t)}var ie,se;function ae(e){return 9===e||32===e}function ce(e,t){switch(typeof e){case"string":return JSON.stringify(e);case"function":return e.name?`[function ${e.name}]`:"[function]";case"object":return function(e,t){if(null===e)return"null";if(t.includes(e))return"[Circular]";const n=[...t,e];if(function(e){return"function"==typeof e.toJSON}(e)){const t=e.toJSON();if(t!==e)return"string"==typeof t?t:ce(t,n)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>2)return"[Array]";const n=Math.min(10,e.length),r=e.length-n,o=[];for(let r=0;r<n;++r)o.push(ce(e[r],t));return 1===r?o.push("... 1 more item"):r>1&&o.push(`... ${r} more items`),"["+o.join(", ")+"]"}(e,n);return function(e,t){const n=Object.entries(e);if(0===n.length)return"{}";if(t.length>2)return"["+function(e){const t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){const t=e.constructor.name;if("string"==typeof t&&""!==t)return t}return t}(e)+"]";const r=n.map((([e,n])=>e+": "+ce(n,t)));return"{ "+r.join(", ")+" }"}(e,n)}(e,t);default:return String(e)}}!function(e){e.QUERY="query",e.MUTATION="mutation",e.SUBSCRIPTION="subscription"}(ie||(ie={})),function(e){e.NAME="Name",e.DOCUMENT="Document",e.OPERATION_DEFINITION="OperationDefinition",e.VARIABLE_DEFINITION="VariableDefinition",e.SELECTION_SET="SelectionSet",e.FIELD="Field",e.ARGUMENT="Argument",e.FRAGMENT_SPREAD="FragmentSpread",e.INLINE_FRAGMENT="InlineFragment",e.FRAGMENT_DEFINITION="FragmentDefinition",e.VARIABLE="Variable",e.INT="IntValue",e.FLOAT="FloatValue",e.STRING="StringValue",e.BOOLEAN="BooleanValue",e.NULL="NullValue",e.ENUM="EnumValue",e.LIST="ListValue",e.OBJECT="ObjectValue",e.OBJECT_FIELD="ObjectField",e.DIRECTIVE="Directive",e.NAMED_TYPE="NamedType",e.LIST_TYPE="ListType",e.NON_NULL_TYPE="NonNullType",e.SCHEMA_DEFINITION="SchemaDefinition",e.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",e.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",e.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",e.FIELD_DEFINITION="FieldDefinition",e.INPUT_VALUE_DEFINITION="InputValueDefinition",e.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",e.UNION_TYPE_DEFINITION="UnionTypeDefinition",e.ENUM_TYPE_DEFINITION="EnumTypeDefinition",e.ENUM_VALUE_DEFINITION="EnumValueDefinition",e.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",e.DIRECTIVE_DEFINITION="DirectiveDefinition",e.SCHEMA_EXTENSION="SchemaExtension",e.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",e.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",e.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",e.UNION_TYPE_EXTENSION="UnionTypeExtension",e.ENUM_TYPE_EXTENSION="EnumTypeExtension",e.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"}(se||(se={}));const le=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function ue(e){return pe[e.charCodeAt(0)]}const pe=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],de=Object.freeze({});function fe(e,t){const n=e[t];return"object"==typeof n?n:"function"==typeof n?{enter:n,leave:void 0}:{enter:e.enter,leave:e.leave}}const he={Name:{leave:e=>e.value},Variable:{leave:e=>"$"+e.name},Document:{leave:e=>me(e.definitions,"\n\n")},OperationDefinition:{leave(e){const t=be("(",me(e.variableDefinitions,", "),")"),n=me([e.operation,me([e.name,t]),me(e.directives," ")]," ");return("query"===n?"":n+" ")+e.selectionSet}},VariableDefinition:{leave:({variable:e,type:t,defaultValue:n,directives:r})=>e+": "+t+be(" = ",n)+be(" ",me(r," "))},SelectionSet:{leave:({selections:e})=>ye(e)},Field:{leave({alias:e,name:t,arguments:n,directives:r,selectionSet:o}){const i=be("",e,": ")+t;let s=i+be("(",me(n,", "),")");return s.length>80&&(s=i+be("(\n",ve(me(n,"\n")),"\n)")),me([s,me(r," "),o]," ")}},Argument:{leave:({name:e,value:t})=>e+": "+t},FragmentSpread:{leave:({name:e,directives:t})=>"..."+e+be(" ",me(t," "))},InlineFragment:{leave:({typeCondition:e,directives:t,selectionSet:n})=>me(["...",be("on ",e),me(t," "),n]," ")},FragmentDefinition:{leave:({name:e,typeCondition:t,variableDefinitions:n,directives:r,selectionSet:o})=>`fragment ${e}${be("(",me(n,", "),")")} on ${t} ${be("",me(r," ")," ")}`+o},IntValue:{leave:({value:e})=>e},FloatValue:{leave:({value:e})=>e},StringValue:{leave:({value:e,block:t})=>t?function(e,t){const n=e.replace(/"""/g,'\\"""'),r=n.split(/\r\n|[\n\r]/g),o=1===r.length,i=r.length>1&&r.slice(1).every((e=>0===e.length||ae(e.charCodeAt(0)))),s=n.endsWith('\\"""'),a=e.endsWith('"')&&!s,c=e.endsWith("\\"),l=a||c,u=!o||e.length>70||l||i||s;let p="";const d=o&&ae(e.charCodeAt(0));return(u&&!d||i)&&(p+="\n"),p+=n,(u||l)&&(p+="\n"),'"""'+p+'"""'}(e):`"${e.replace(le,ue)}"`},BooleanValue:{leave:({value:e})=>e?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:e})=>e},ListValue:{leave:({values:e})=>"["+me(e,", ")+"]"},ObjectValue:{leave:({fields:e})=>"{"+me(e,", ")+"}"},ObjectField:{leave:({name:e,value:t})=>e+": "+t},Directive:{leave:({name:e,arguments:t})=>"@"+e+be("(",me(t,", "),")")},NamedType:{leave:({name:e})=>e},ListType:{leave:({type:e})=>"["+e+"]"},NonNullType:{leave:({type:e})=>e+"!"},SchemaDefinition:{leave:({description:e,directives:t,operationTypes:n})=>be("",e,"\n")+me(["schema",me(t," "),ye(n)]," ")},OperationTypeDefinition:{leave:({operation:e,type:t})=>e+": "+t},ScalarTypeDefinition:{leave:({description:e,name:t,directives:n})=>be("",e,"\n")+me(["scalar",t,me(n," ")]," ")},ObjectTypeDefinition:{leave:({description:e,name:t,interfaces:n,directives:r,fields:o})=>be("",e,"\n")+me(["type",t,be("implements ",me(n," & ")),me(r," "),ye(o)]," ")},FieldDefinition:{leave:({description:e,name:t,arguments:n,type:r,directives:o})=>be("",e,"\n")+t+(ge(n)?be("(\n",ve(me(n,"\n")),"\n)"):be("(",me(n,", "),")"))+": "+r+be(" ",me(o," "))},InputValueDefinition:{leave:({description:e,name:t,type:n,defaultValue:r,directives:o})=>be("",e,"\n")+me([t+": "+n,be("= ",r),me(o," ")]," ")},InterfaceTypeDefinition:{leave:({description:e,name:t,interfaces:n,directives:r,fields:o})=>be("",e,"\n")+me(["interface",t,be("implements ",me(n," & ")),me(r," "),ye(o)]," ")},UnionTypeDefinition:{leave:({description:e,name:t,directives:n,types:r})=>be("",e,"\n")+me(["union",t,me(n," "),be("= ",me(r," | "))]," ")},EnumTypeDefinition:{leave:({description:e,name:t,directives:n,values:r})=>be("",e,"\n")+me(["enum",t,me(n," "),ye(r)]," ")},EnumValueDefinition:{leave:({description:e,name:t,directives:n})=>be("",e,"\n")+me([t,me(n," ")]," ")},InputObjectTypeDefinition:{leave:({description:e,name:t,directives:n,fields:r})=>be("",e,"\n")+me(["input",t,me(n," "),ye(r)]," ")},DirectiveDefinition:{leave:({description:e,name:t,arguments:n,repeatable:r,locations:o})=>be("",e,"\n")+"directive @"+t+(ge(n)?be("(\n",ve(me(n,"\n")),"\n)"):be("(",me(n,", "),")"))+(r?" repeatable":"")+" on "+me(o," | ")},SchemaExtension:{leave:({directives:e,operationTypes:t})=>me(["extend schema",me(e," "),ye(t)]," ")},ScalarTypeExtension:{leave:({name:e,directives:t})=>me(["extend scalar",e,me(t," ")]," ")},ObjectTypeExtension:{leave:({name:e,interfaces:t,directives:n,fields:r})=>me(["extend type",e,be("implements ",me(t," & ")),me(n," "),ye(r)]," ")},InterfaceTypeExtension:{leave:({name:e,interfaces:t,directives:n,fields:r})=>me(["extend interface",e,be("implements ",me(t," & ")),me(n," "),ye(r)]," ")},UnionTypeExtension:{leave:({name:e,directives:t,types:n})=>me(["extend union",e,me(t," "),be("= ",me(n," | "))]," ")},EnumTypeExtension:{leave:({name:e,directives:t,values:n})=>me(["extend enum",e,me(t," "),ye(n)]," ")},InputObjectTypeExtension:{leave:({name:e,directives:t,fields:n})=>me(["extend input",e,me(t," "),ye(n)]," ")}};function me(e,t=""){var n;return null!==(n=null==e?void 0:e.filter((e=>e)).join(t))&&void 0!==n?n:""}function ye(e){return be("{\n",ve(me(e,"\n")),"\n}")}function be(e,t,n=""){return null!=t&&""!==t?e+t+n:""}function ve(e){return be("  ",e.replace(/\n/g,"\n  "))}function ge(e){var t;return null!==(t=null==e?void 0:e.some((e=>e.includes("\n"))))&&void 0!==t&&t}var Ee={__proto__:null,print:function(e){return function(e,t,n=ne){const r=new Map;for(const e of Object.values(se))r.set(e,fe(t,e));let o,i,s,a=Array.isArray(e),c=[e],l=-1,u=[],p=e;const d=[],f=[];do{l++;const e=l===c.length,v=e&&0!==u.length;if(e){if(i=0===f.length?void 0:d[d.length-1],p=s,s=f.pop(),v)if(a){p=p.slice();let e=0;for(const[t,n]of u){const r=t-e;null===n?(p.splice(r,1),e++):p[r]=n}}else{p=Object.defineProperties({},Object.getOwnPropertyDescriptors(p));for(const[e,t]of u)p[e]=t}l=o.index,c=o.keys,u=o.edits,a=o.inArray,o=o.prev}else if(s){if(i=a?l:c[l],p=s[i],null==p)continue;d.push(i)}let g;if(!Array.isArray(p)){var h,m;oe(p)||te(!1,`Invalid AST Node: ${b=p,ce(b,[])}.`);const n=e?null===(h=r.get(p.kind))||void 0===h?void 0:h.leave:null===(m=r.get(p.kind))||void 0===m?void 0:m.enter;if(g=null==n?void 0:n.call(t,p,i,s,d,f),g===de)break;if(!1===g){if(!e){d.pop();continue}}else if(void 0!==g&&(u.push([i,g]),!e)){if(!oe(g)){d.pop();continue}p=g}}var y;void 0===g&&v&&u.push([i,p]),e?d.pop():(o={inArray:a,index:l,keys:c,edits:u,prev:o},a=Array.isArray(p),c=a?p:null!==(y=n[p.kind])&&void 0!==y?y:[],l=-1,u=[],s&&f.push(s),s=p)}while(void 0!==o);var b;return 0!==u.length?u[u.length-1][1]:e}(e,he)}},Te={__proto__:null,getOperationAST:function(e,t){let n=null;for(const o of e.definitions){var r;if(o.kind===se.OPERATION_DEFINITION)if(null==t){if(n)return null;n=o}else if((null===(r=o.name)||void 0===r?void 0:r.value)===t)return o}return n}},we={},Ie=_e;function _e(e){this.ms=(e=e||{}).min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}_e.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},_e.prototype.reset=function(){this.attempts=0},_e.prototype.setMin=function(e){this.ms=e},_e.prototype.setMax=function(e){this.max=e},_e.prototype.setJitter=function(e){this.jitter=e};var Se={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=this._events[n?n+e:e];if(!t)return[];if(t.fn)return[t.fn];for(var r=0,o=t.length,i=new Array(o);r<o;r++)i[r]=t[r].fn;return i},a.prototype.listenerCount=function(e){var t=this._events[n?n+e:e];return t?t.fn?1:t.length:0},a.prototype.emit=function(e,t,r,o,i,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],p=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),p){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,o),!0;case 5:return u.fn.call(u.context,t,r,o,i),!0;case 6:return u.fn.call(u.context,t,r,o,i,s),!0}for(l=1,c=new Array(p-1);l<p;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var d,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),p){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,o);break;default:if(!c)for(d=1,c=new Array(p-1);d<p;d++)c[d-1]=arguments[d];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||r&&a.context!==r||s(this,i);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||o&&!a[c].once||r&&a[c].context!==r)&&l.push(a[c]);l.length?this._events[i]=1===l.length?l[0]:l:s(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?this._events[t=n?n+e:e]&&s(this,t):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}(Se);var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.default=function(e){return"string"==typeof e};var xe={};Object.defineProperty(xe,"__esModule",{value:!0}),xe.default=function(e){return null!==e&&"object"==typeof e};var Ne=a(Ee),Ce=a(Te),Ae=a({__proto__:null,default:function(e){var t,n=("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()).Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}()}),ke={};Object.defineProperty(ke,"__esModule",{value:!0}),ke.GRAPHQL_SUBSCRIPTIONS=ke.GRAPHQL_WS=void 0,ke.GRAPHQL_WS="graphql-ws",ke.GRAPHQL_SUBSCRIPTIONS="graphql-subscriptions";var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.WS_TIMEOUT=Pe.MIN_WS_TIMEOUT=void 0,Pe.MIN_WS_TIMEOUT=1e3,Pe.WS_TIMEOUT=3e4;var Re={};Object.defineProperty(Re,"__esModule",{value:!0});var je=function(){function e(){throw new Error("Static Class")}return e.GQL_CONNECTION_INIT="connection_init",e.GQL_CONNECTION_ACK="connection_ack",e.GQL_CONNECTION_ERROR="connection_error",e.GQL_CONNECTION_KEEP_ALIVE="ka",e.GQL_CONNECTION_TERMINATE="connection_terminate",e.GQL_START="start",e.GQL_DATA="data",e.GQL_ERROR="error",e.GQL_COMPLETE="complete",e.GQL_STOP="stop",e.SUBSCRIPTION_START="subscription_start",e.SUBSCRIPTION_DATA="subscription_data",e.SUBSCRIPTION_SUCCESS="subscription_success",e.SUBSCRIPTION_FAIL="subscription_fail",e.SUBSCRIPTION_END="subscription_end",e.INIT="init",e.INIT_SUCCESS="init_success",e.INIT_FAIL="init_fail",e.KEEP_ALIVE="keepalive",e}();Re.default=je;var Me=s&&s.__assign||function(){return Me=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Me.apply(this,arguments)},Fe=s&&s.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},De=s&&s.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Le=s&&s.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(we,"__esModule",{value:!0});var Ue=we.SubscriptionClient=void 0,qe=void 0!==s?s:"undefined"!=typeof window?window:{},$e=qe.WebSocket||qe.MozWebSocket,Ve=Ie,Ge=Se.exports,Qe=Oe,We=xe,Be=Ne,Je=Ce,He=Ae,ze=ke,Ke=Pe,Ye=Re,Xe=function(){function e(e,t,n,r){var o=t||{},i=o.connectionCallback,s=void 0===i?void 0:i,a=o.connectionParams,c=void 0===a?{}:a,l=o.minTimeout,u=void 0===l?Ke.MIN_WS_TIMEOUT:l,p=o.timeout,d=void 0===p?Ke.WS_TIMEOUT:p,f=o.reconnect,h=void 0!==f&&f,m=o.reconnectionAttempts,y=void 0===m?Infinity:m,b=o.lazy,v=void 0!==b&&b,g=o.inactivityTimeout,E=void 0===g?0:g,T=o.wsOptionArguments,w=void 0===T?[]:T;if(this.wsImpl=n||$e,!this.wsImpl)throw new Error("Unable to find native implementation, or alternative implementation for WebSocket!");this.wsProtocols=r||ze.GRAPHQL_WS,this.connectionCallback=s,this.url=e,this.operations={},this.nextOperationId=0,this.minWsTimeout=u,this.wsTimeout=d,this.unsentMessagesQueue=[],this.reconnect=h,this.reconnecting=!1,this.reconnectionAttempts=y,this.lazy=!!v,this.inactivityTimeout=E,this.closedByUser=!1,this.backoff=new Ve({jitter:.5}),this.eventEmitter=new Ge.EventEmitter,this.middlewares=[],this.client=null,this.maxConnectTimeGenerator=this.createMaxConnectTimeGenerator(),this.connectionParams=this.getConnectionParams(c),this.wsOptionArguments=w,this.lazy||this.connect()}return Object.defineProperty(e.prototype,"status",{get:function(){return null===this.client?this.wsImpl.CLOSED:this.client.readyState},enumerable:!1,configurable:!0}),e.prototype.close=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this.clearInactivityTimeout(),null!==this.client&&(this.closedByUser=t,e&&(this.clearCheckConnectionInterval(),this.clearMaxConnectTimeout(),this.clearTryReconnectTimeout(),this.unsubscribeAll(),this.sendMessage(void 0,Ye.default.GQL_CONNECTION_TERMINATE,null)),this.client.close(),this.client.onopen=null,this.client.onclose=null,this.client.onerror=null,this.client.onmessage=null,this.client=null,this.eventEmitter.emit("disconnected"),e||this.tryReconnect())},e.prototype.request=function(e){var t,n,r=this.getObserver.bind(this),o=this.executeOperation.bind(this),i=this.unsubscribe.bind(this);return this.clearInactivityTimeout(),(t={})[He.default]=function(){return this},t.subscribe=function(t,s,a){var c=r(t,s,a);return n=o(e,(function(e,t){null===e&&null===t?c.complete&&c.complete():e?c.error&&c.error(e[0]):c.next&&c.next(t)})),{unsubscribe:function(){n&&(i(n),n=null)}}},t},e.prototype.on=function(e,t,n){var r=this.eventEmitter.on(e,t,n);return function(){r.off(e,t,n)}},e.prototype.onConnected=function(e,t){return this.on("connected",e,t)},e.prototype.onConnecting=function(e,t){return this.on("connecting",e,t)},e.prototype.onDisconnected=function(e,t){return this.on("disconnected",e,t)},e.prototype.onReconnected=function(e,t){return this.on("reconnected",e,t)},e.prototype.onReconnecting=function(e,t){return this.on("reconnecting",e,t)},e.prototype.onError=function(e,t){return this.on("error",e,t)},e.prototype.unsubscribeAll=function(){var e=this;Object.keys(this.operations).forEach((function(t){e.unsubscribe(t)}))},e.prototype.applyMiddlewares=function(e){var t=this;return new Promise((function(n,r){var o,i,s;o=Le([],t.middlewares,!0),i=t,(s=function(t){if(t)r(t);else if(o.length>0){var a=o.shift();a&&a.applyMiddleware.apply(i,[e,s])}else n(e)})()}))},e.prototype.use=function(e){var t=this;return e.map((function(e){if("function"!=typeof e.applyMiddleware)throw new Error("Middleware must implement the applyMiddleware function.");t.middlewares.push(e)})),this},e.prototype.getConnectionParams=function(e){return function(){return new Promise((function(t,n){if("function"==typeof e)try{return t(e.call(null))}catch(e){return n(e)}t(e)}))}},e.prototype.executeOperation=function(e,t){var n=this;null===this.client&&this.connect();var r=this.generateOperationId();return this.operations[r]={options:e,handler:t},this.applyMiddlewares(e).then((function(e){n.checkOperationOptions(e,t),n.operations[r]&&(n.operations[r]={options:e,handler:t},n.sendMessage(r,Ye.default.GQL_START,e))})).catch((function(e){n.unsubscribe(r),t(n.formatErrors(e))})),r},e.prototype.getObserver=function(e,t,n){return"function"==typeof e?{next:function(t){return e(t)},error:function(e){return t&&t(e)},complete:function(){return n&&n()}}:e},e.prototype.createMaxConnectTimeGenerator=function(){return new Ve({min:this.minWsTimeout,max:this.wsTimeout,factor:1.2})},e.prototype.clearCheckConnectionInterval=function(){this.checkConnectionIntervalId&&(clearInterval(this.checkConnectionIntervalId),this.checkConnectionIntervalId=null)},e.prototype.clearMaxConnectTimeout=function(){this.maxConnectTimeoutId&&(clearTimeout(this.maxConnectTimeoutId),this.maxConnectTimeoutId=null)},e.prototype.clearTryReconnectTimeout=function(){this.tryReconnectTimeoutId&&(clearTimeout(this.tryReconnectTimeoutId),this.tryReconnectTimeoutId=null)},e.prototype.clearInactivityTimeout=function(){this.inactivityTimeoutId&&(clearTimeout(this.inactivityTimeoutId),this.inactivityTimeoutId=null)},e.prototype.setInactivityTimeout=function(){var e=this;this.inactivityTimeout>0&&0===Object.keys(this.operations).length&&(this.inactivityTimeoutId=setTimeout((function(){0===Object.keys(e.operations).length&&e.close()}),this.inactivityTimeout))},e.prototype.checkOperationOptions=function(e,t){var n=e.query,r=e.variables,o=e.operationName;if(!n)throw new Error("Must provide a query.");if(!t)throw new Error("Must provide an handler.");if(!(0,Qe.default)(n)&&!(0,Je.getOperationAST)(n,o)||o&&!(0,Qe.default)(o)||r&&!(0,We.default)(r))throw new Error("Incorrect option types. query must be a string or a document,`operationName` must be a string, and `variables` must be an object.")},e.prototype.buildMessage=function(e,t,n){return{id:e,type:t,payload:n&&n.query?Me(Me({},n),{query:"string"==typeof n.query?n.query:(0,Be.print)(n.query)}):n}},e.prototype.formatErrors=function(e){return Array.isArray(e)?e:e&&e.errors?this.formatErrors(e.errors):e&&e.message?[e]:[{name:"FormatedError",message:"Unknown error",originalError:e}]},e.prototype.sendMessage=function(e,t,n){this.sendMessageRaw(this.buildMessage(e,t,n))},e.prototype.sendMessageRaw=function(e){switch(this.status){case this.wsImpl.OPEN:var t=JSON.stringify(e);try{JSON.parse(t)}catch(t){this.eventEmitter.emit("error",new Error("Message must be JSON-serializable. Got: "+e))}this.client.send(t);break;case this.wsImpl.CONNECTING:this.unsentMessagesQueue.push(e);break;default:this.reconnecting||this.eventEmitter.emit("error",new Error("A message was not sent because socket is not connected, is closing or is already closed. Message was: "+JSON.stringify(e)))}},e.prototype.generateOperationId=function(){return String(++this.nextOperationId)},e.prototype.tryReconnect=function(){var e=this;if(this.reconnect&&!(this.backoff.attempts>=this.reconnectionAttempts)){this.reconnecting||(Object.keys(this.operations).forEach((function(t){e.unsentMessagesQueue.push(e.buildMessage(t,Ye.default.GQL_START,e.operations[t].options))})),this.reconnecting=!0),this.clearTryReconnectTimeout();var t=this.backoff.duration();this.tryReconnectTimeoutId=setTimeout((function(){e.connect()}),t)}},e.prototype.flushUnsentMessagesQueue=function(){var e=this;this.unsentMessagesQueue.forEach((function(t){e.sendMessageRaw(t)})),this.unsentMessagesQueue=[]},e.prototype.checkConnection=function(){this.wasKeepAliveReceived?this.wasKeepAliveReceived=!1:this.reconnecting||this.close(!1,!0)},e.prototype.checkMaxConnectTimeout=function(){var e=this;this.clearMaxConnectTimeout(),this.maxConnectTimeoutId=setTimeout((function(){e.status!==e.wsImpl.OPEN&&(e.reconnecting=!0,e.close(!1,!0))}),this.maxConnectTimeGenerator.duration())},e.prototype.connect=function(){var e,t=this;this.client=new((e=this.wsImpl).bind.apply(e,Le([void 0,this.url,this.wsProtocols],this.wsOptionArguments,!1))),this.checkMaxConnectTimeout(),this.client.onopen=function(){return Fe(t,void 0,void 0,(function(){var e,t;return De(this,(function(n){switch(n.label){case 0:if(this.status!==this.wsImpl.OPEN)return[3,4];this.clearMaxConnectTimeout(),this.closedByUser=!1,this.eventEmitter.emit(this.reconnecting?"reconnecting":"connecting"),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.connectionParams()];case 2:return e=n.sent(),this.sendMessage(void 0,Ye.default.GQL_CONNECTION_INIT,e),this.flushUnsentMessagesQueue(),[3,4];case 3:return t=n.sent(),this.sendMessage(void 0,Ye.default.GQL_CONNECTION_ERROR,t),this.flushUnsentMessagesQueue(),[3,4];case 4:return[2]}}))}))},this.client.onclose=function(){t.closedByUser||t.close(!1,!1)},this.client.onerror=function(e){t.eventEmitter.emit("error",e)},this.client.onmessage=function(e){t.processReceivedData(e.data)}},e.prototype.processReceivedData=function(e){var t,n;try{n=(t=JSON.parse(e)).id}catch(t){throw new Error("Message must be JSON-parseable. Got: "+e)}if(-1===[Ye.default.GQL_DATA,Ye.default.GQL_COMPLETE,Ye.default.GQL_ERROR].indexOf(t.type)||this.operations[n])switch(t.type){case Ye.default.GQL_CONNECTION_ERROR:this.connectionCallback&&this.connectionCallback(t.payload);break;case Ye.default.GQL_CONNECTION_ACK:this.eventEmitter.emit(this.reconnecting?"reconnected":"connected",t.payload),this.reconnecting=!1,this.backoff.reset(),this.maxConnectTimeGenerator.reset(),this.connectionCallback&&this.connectionCallback();break;case Ye.default.GQL_COMPLETE:var r=this.operations[n].handler;delete this.operations[n],r.call(this,null,null);break;case Ye.default.GQL_ERROR:this.operations[n].handler(this.formatErrors(t.payload),null),delete this.operations[n];break;case Ye.default.GQL_DATA:var o=t.payload.errors?Me(Me({},t.payload),{errors:this.formatErrors(t.payload.errors)}):t.payload;this.operations[n].handler(null,o);break;case Ye.default.GQL_CONNECTION_KEEP_ALIVE:var i=void 0===this.wasKeepAliveReceived;this.wasKeepAliveReceived=!0,i&&this.checkConnection(),this.checkConnectionIntervalId&&(clearInterval(this.checkConnectionIntervalId),this.checkConnection()),this.checkConnectionIntervalId=setInterval(this.checkConnection.bind(this),this.wsTimeout);break;default:throw new Error("Invalid message type!")}else this.unsubscribe(n)},e.prototype.unsubscribe=function(e){this.operations[e]&&(delete this.operations[e],this.setInactivityTimeout(),this.sendMessage(e,Ye.default.GQL_STOP,void 0))},e}();function Ze(e){throw new Error(`Didn't expect to get here ${e}`)}Ue=we.SubscriptionClient=Xe;class et{constructor(e,t,n){this.unsubscribeFunctions=[],this.protocol=n,this.url=e,this.headers=t}get graphWsClient(){var e,t;const n=null!==(e=this._graphWsClient)&&void 0!==e?e:function(e){const{url:t,connectionParams:n,lazy:r=!0,onNonLazyError:o=console.error,lazyCloseTimeout:i=0,keepAlive:s=0,disablePong:a,connectionAckWaitTimeout:c=0,retryAttempts:l=5,retryWait:u=async function(e){let t=1e3;for(let n=0;n<e;n++)t*=2;await new Promise((e=>setTimeout(e,t+Math.floor(2700*Math.random()+300))))},shouldRetry:p=ee,isFatalConnectionProblem:d,on:f,webSocketImpl:h,generateID:m=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},jsonMessageReplacer:y,jsonMessageReviver:b}=e;let v;if(h){if(!("function"==typeof(g=h)&&"constructor"in g&&"CLOSED"in g&&"CLOSING"in g&&"CONNECTING"in g&&"OPEN"in g))throw new Error("Invalid WebSocket implementation provided");v=h}else"undefined"!=typeof WebSocket?v=WebSocket:"undefined"!=typeof global?v=global.WebSocket||global.MozWebSocket:"undefined"!=typeof window&&(v=window.WebSocket||window.MozWebSocket);var g;if(!v)throw new Error("WebSocket implementation missing; on Node you can `import WebSocket from 'ws';` and pass `webSocketImpl: WebSocket` to `createClient`");const E=v,T=(()=>{const e=(()=>{const e={};return{on:(t,n)=>(e[t]=n,()=>{delete e[t]}),emit(t){var n;"id"in t&&(null===(n=e[t.id])||void 0===n||n.call(e,t))}}})(),t={connecting:(null==f?void 0:f.connecting)?[f.connecting]:[],opened:(null==f?void 0:f.opened)?[f.opened]:[],connected:(null==f?void 0:f.connected)?[f.connected]:[],ping:(null==f?void 0:f.ping)?[f.ping]:[],pong:(null==f?void 0:f.pong)?[f.pong]:[],message:(null==f?void 0:f.message)?[e.emit,f.message]:[e.emit],closed:(null==f?void 0:f.closed)?[f.closed]:[],error:(null==f?void 0:f.error)?[f.error]:[]};return{onMessage:e.on,on(e,n){const r=t[e];return r.push(n),()=>{r.splice(r.indexOf(n),1)}},emit(e,...n){for(const r of[...t[e]])r(...n)}}})();function w(e){const t=[T.on("error",(n=>{t.forEach((e=>e())),e(n)})),T.on("closed",(n=>{t.forEach((e=>e())),e(n)}))]}let I,_=0,S=!1,O=0,x=!1;async function N(){const[e,r]=await(null!=I?I:I=new Promise(((e,r)=>(async()=>{if(S){if(await u(O),!_)return I=void 0,r({code:1e3,reason:"All Subscriptions Gone"});O++}T.emit("connecting");const o=new E("function"==typeof t?await t():t,"graphql-transport-ws");let i,l;function p(){isFinite(s)&&s>0&&(clearTimeout(l),l=setTimeout((()=>{o.readyState===E.OPEN&&(o.send(Z({type:G.Ping})),T.emit("ping",!1,void 0))}),s))}w((e=>{I=void 0,clearTimeout(i),clearTimeout(l),r(e),ee(e)&&4499===e.code&&(o.close(4499,"Terminated"),o.onerror=null,o.onclose=null)})),o.onerror=e=>T.emit("error",e),o.onclose=e=>T.emit("closed",e),o.onopen=async()=>{try{T.emit("opened",o);const e="function"==typeof n?await n():n;if(o.readyState!==E.OPEN)return;o.send(Z(e?{type:G.ConnectionInit,payload:e}:{type:G.ConnectionInit},y)),isFinite(c)&&c>0&&(i=setTimeout((()=>{o.close(V.ConnectionAcknowledgementTimeout,"Connection acknowledgement timeout")}),c)),p()}catch(e){T.emit("error",e),o.close(V.InternalClientError,Y(e instanceof Error?e.message:new Error(e).message,"Internal client error"))}};let d=!1;o.onmessage=({data:t})=>{try{const n=function(e,t){try{return X(e)}catch(n){if("string"!=typeof e)throw new Error("Only strings are parsable messages");return X(JSON.parse(e,t))}}(t,b);if(T.emit("message",n),"ping"===n.type||"pong"===n.type)return T.emit(n.type,!0,n.payload),void("pong"===n.type?p():a||(o.send(Z(n.payload?{type:G.Pong,payload:n.payload}:{type:G.Pong})),T.emit("pong",!1,n.payload)));if(d)return;if(n.type!==G.ConnectionAck)throw new Error(`First message cannot be of type ${n.type}`);clearTimeout(i),d=!0,T.emit("connected",o,n.payload),S=!1,O=0,e([o,new Promise(((e,t)=>w(t)))])}catch(e){o.onmessage=null,T.emit("error",e),o.close(V.BadResponse,Y(e instanceof Error?e.message:new Error(e).message,"Bad response"))}}})())));e.readyState===E.CLOSING&&await r;let o=()=>{};const l=new Promise((e=>o=e));return[e,o,Promise.race([l.then((()=>{if(!_){const t=()=>e.close(1e3,"Normal Closure");isFinite(i)&&i>0?setTimeout((()=>{_||e.readyState!==E.OPEN||t()}),i):t()}})),r])]}function C(e){if(ee(e)&&(![1e3,1001,1006,1005,1012,1013,1013].includes(t=e.code)&&t>=1e3&&t<=1999||[V.InternalServerError,V.InternalClientError,V.BadRequest,V.BadResponse,V.Unauthorized,V.SubprotocolNotAcceptable,V.SubscriberAlreadyExists,V.TooManyInitialisationRequests].includes(e.code)))throw e;var t;if(x)return!1;if(ee(e)&&1e3===e.code)return _>0;if(!l||O>=l)throw e;if(!p(e))throw e;if(null==d?void 0:d(e))throw e;return S=!0}return r||(async()=>{for(_++;;)try{const[,,e]=await N();await e}catch(e){try{if(!C(e))return}catch(e){return null==o?void 0:o(e)}}})(),{on:T.on,subscribe(e,t){const n=m();let r=!1,o=!1,i=()=>{_--,r=!0};return(async()=>{for(_++;;)try{const[s,a,c]=await N();if(r)return a();const l=T.onMessage(n,(e=>{switch(e.type){case G.Next:return void t.next(e.payload);case G.Error:return o=!0,r=!0,t.error(e.payload),void i();case G.Complete:return r=!0,void i()}}));return s.send(Z({id:n,type:G.Subscribe,payload:e},y)),i=()=>{r||s.readyState!==E.OPEN||s.send(Z({id:n,type:G.Complete},y)),_--,r=!0,a()},void await c.finally(l)}catch(e){if(!C(e))return}})().then((()=>{o||t.complete()})).catch((e=>{t.error(e)})),()=>{r||i()}},async dispose(){if(x=!0,I){const[e]=await I;e.close(1e3,"Normal Closure")}},terminate(){I&&T.emit("closed",{code:4499,reason:"Terminated",wasClean:!1})}}}({url:this.url,lazy:!0,connectionParams:null!==(t=this.headers)&&void 0!==t?t:{},keepAlive:1e4});return this._graphWsClient=n,n}get transportSubscriptionClient(){var e,t;const n=null!==(e=this._transportSubscriptionClient)&&void 0!==e?e:new Ue(this.url,{reconnect:!0,lazy:!0,connectionParams:null!==(t=this.headers)&&void 0!==t?t:{}});return this._transportSubscriptionClient=n,n}onConnected(e){return"graphql-ws"===this.protocol?this.graphWsClient.on("connected",e):"subscriptions-transport-ws"===this.protocol?this.transportSubscriptionClient.onConnected(e):void Ze(this.protocol)}onConnecting(e){return"graphql-ws"===this.protocol?this.graphWsClient.on("connecting",e):"subscriptions-transport-ws"===this.protocol?this.transportSubscriptionClient.onConnecting(e):void Ze(this.protocol)}onError(e){return"graphql-ws"===this.protocol?this.graphWsClient.on("error",(t=>e(t))):"subscriptions-transport-ws"===this.protocol?this.transportSubscriptionClient.onError((t=>e(t))):void Ze(this.protocol)}onReconnecting(e){if("graphql-ws"!==this.protocol)return"subscriptions-transport-ws"===this.protocol?this.transportSubscriptionClient.onReconnecting(e):void Ze(this.protocol)}onReconnected(e){if("graphql-ws"!==this.protocol)return"subscriptions-transport-ws"===this.protocol?this.transportSubscriptionClient.onReconnected(e):void Ze(this.protocol)}onDisconnected(e){return"graphql-ws"===this.protocol?this.graphWsClient.on("closed",e):"subscriptions-transport-ws"===this.protocol?this.transportSubscriptionClient.onDisconnected(e):void Ze(this.protocol)}request(e){return{subscribe:t=>("graphql-ws"===this.protocol&&this.unsubscribeFunctions.push(this.graphWsClient.subscribe(e,Object.assign(Object.assign({},t),{next:e=>{var n;return null===(n=t.next)||void 0===n?void 0:n.call(t,e)},error:e=>{var n;return null===(n=t.error)||void 0===n?void 0:n.call(t,e)},complete:()=>{}}))),"subscriptions-transport-ws"===this.protocol?this.transportSubscriptionClient.request(e).subscribe(t):void 0)}}unsubscribeAll(){if("graphql-ws"===this.protocol&&(this.unsubscribeFunctions.forEach((e=>{e()})),this.unsubscribeFunctions=[]),"subscriptions-transport-ws"===this.protocol)return this.transportSubscriptionClient.unsubscribeAll()}}function tt({error:e,embeddedIFrameElement:t,embedUrl:n}){H({message:{name:"ExplorerSetSocketError",error:e},embeddedIFrameElement:t,embedUrl:n})}function nt({status:e,embeddedIFrameElement:t,embedUrl:n}){H({message:{name:"ExplorerSetSocketStatus",status:e},embeddedIFrameElement:t,embedUrl:n})}let rt=0;return class{constructor(i){var s;this.options=i,this.__testLocal__=!!this.options.__testLocal__,this.validateOptions(),this.handleRequest=null!==(s=this.options.handleRequest)&&void 0!==s?s:(({includeCookies:e})=>(t,n)=>fetch(t,Object.assign(Object.assign({},n),e?{credentials:"include"}:{credentials:"omit"})))({includeCookies:!!this.options.includeCookies}),this.uniqueEmbedInstanceId=rt++,this.embeddedSandboxIFrameElement=this.injectEmbed(),this.disposable=function({handleRequest:i,embeddedSandboxIFrameElement:s,__testLocal__:a}){const c=e(a),l=e=>{(({event:e,embeddedIFrameElement:t,embedUrl:n})=>{const{data:r}=e;if("SetPartialAuthenticationTokenForParent"===r.name){const e=window.localStorage.getItem("apolloStudioEmbeddedExplorerEncodedApiKey"),t=e?JSON.parse(e):{};t[r.localStorageKey]=r.partialToken,window.localStorage.setItem("apolloStudioEmbeddedExplorerEncodedApiKey",JSON.stringify(t))}if("TriggerLogoutInParent"===r.name){const e=window.localStorage.getItem("apolloStudioEmbeddedExplorerEncodedApiKey"),o=e?JSON.parse(e):{};delete o[r.localStorageKey],window.localStorage.setItem("apolloStudioEmbeddedExplorerEncodedApiKey",JSON.stringify(o)),H({message:{name:"ParentLogoutSuccess"},embeddedIFrameElement:t,embedUrl:n})}if("ExplorerListeningForPartialToken"===r.name&&r.localStorageKey){const e=window.localStorage.getItem("apolloStudioEmbeddedExplorerEncodedApiKey"),o=e?JSON.parse(e):{};o&&o[r.localStorageKey]&&H({message:{name:"PartialAuthenticationTokenResponse",partialToken:o[r.localStorageKey]},embeddedIFrameElement:t,embedUrl:n})}})({event:e,embedUrl:c,embeddedIFrameElement:s});const a="object"==typeof e.data?e.data:void 0;if(a&&"name"in a){if("ExplorerListeningForHandshake"===a.name&&H({message:{name:"HandshakeResponse",parentHref:window.location.href},embeddedIFrameElement:s,embedUrl:c}),"IntrospectionQueryWithHeaders"===a.name){const{introspectionRequestBody:e,introspectionRequestHeaders:r,sandboxEndpointUrl:o}=a;o&&function({endpointUrl:e,headers:r,introspectionRequestBody:o,embeddedIFrameElement:i,embedUrl:s,handleRequest:a}){const{query:c,operationName:l}=JSON.parse(o);a(e,{method:"POST",headers:J(r),body:JSON.stringify({query:c,operationName:l})}).then((e=>e.json())).then((e=>{e.errors&&e.errors.length&&H({message:{name:t,errors:e.errors},embeddedIFrameElement:i,embedUrl:s}),H({message:{name:n,schema:e.data},embeddedIFrameElement:i,embedUrl:s})})).catch((e=>{H({message:{name:t,error:e},embeddedIFrameElement:i,embedUrl:s})}))}({endpointUrl:o,introspectionRequestBody:e,headers:r,embeddedIFrameElement:s,embedUrl:c,handleRequest:i})}const e="ExplorerRequest"===a.name,l="ExplorerSubscriptionRequest"===a.name;if((e||l)&&a.operation&&a.operationId){const{operation:t,operationId:n,operationName:u,variables:p,headers:d,endpointUrl:_,sandboxEndpointUrl:S}=a;e&&_?function({endpointUrl:e,handleRequest:t,operation:n,operationName:o,variables:i,headers:s,embeddedIFrameElement:a,operationId:c,embedUrl:l}){t(e,{method:"POST",headers:J(s),body:JSON.stringify({query:n,variables:i,operationName:o})}).then((e=>{return t=this,o=function*(){var t;const n={};e.headers.forEach(((e,t)=>{n[t]=e}));const o=null===(t=e.headers)||void 0===t?void 0:t.get("content-type"),i=o&&new class{constructor(e){const t=(e=>{e=f(e);let t=0,n="";for(;t<e.length&&"/"!==e[t];)n+=e[t],++t;if(0===n.length||!y(n))return null;if(t>=e.length)return null;++t;let r="";for(;t<e.length&&";"!==e[t];)r+=e[t],++t;if(r=h(r),0===r.length||!y(r))return null;const o={type:v(n),subtype:v(r),parameters:new Map};for(;t<e.length;){for(++t;m(e[t]);)++t;let n="";for(;t<e.length&&";"!==e[t]&&"="!==e[t];)n+=e[t],++t;if(n=v(n),t<e.length){if(";"===e[t])continue;++t}let r=null;if('"'===e[t])for([r,t]=g(e,t);t<e.length&&";"!==e[t];)++t;else{for(r="";t<e.length&&";"!==e[t];)r+=e[t],++t;if(r=h(r),""===r)continue}n.length>0&&y(n)&&b(r)&&!o.parameters.has(n)&&o.parameters.set(n,r)}return o})(e=String(e));if(null===t)throw new Error(`Could not parse MIME type string "${e}"`);this._type=t.type,this._subtype=t.subtype,this._parameters=new T(t.parameters)}static parse(e){try{return new this(e)}catch(e){return null}}get essence(){return`${this.type}/${this.subtype}`}get type(){return this._type}set type(e){if(0===(e=w(String(e))).length)throw new Error("Invalid type: must be a non-empty string");if(!I(e))throw new Error(`Invalid type ${e}: must contain only HTTP token code points`);this._type=e}get subtype(){return this._subtype}set subtype(e){if(0===(e=w(String(e))).length)throw new Error("Invalid subtype: must be a non-empty string");if(!I(e))throw new Error(`Invalid subtype ${e}: must contain only HTTP token code points`);this._subtype=e}get parameters(){return this._parameters}toString(){return(e=>{let t=`${e.type}/${e.subtype}`;if(0===e.parameters.size)return t;for(let[n,r]of e.parameters)t+=";",t+=n,t+="=",E(r)&&0!==r.length||(r=r.replace(/(["\\])/gu,"\\$1"),r=`"${r}"`),t+=r;return t})(this)}isJavaScript({prohibitParameters:e=!1}={}){switch(this._type){case"text":switch(this._subtype){case"ecmascript":case"javascript":case"javascript1.0":case"javascript1.1":case"javascript1.2":case"javascript1.3":case"javascript1.4":case"javascript1.5":case"jscript":case"livescript":case"x-ecmascript":case"x-javascript":return!e||0===this._parameters.size;default:return!1}case"application":switch(this._subtype){case"ecmascript":case"javascript":case"x-ecmascript":case"x-javascript":return!e||0===this._parameters.size;default:return!1}default:return!1}}isXML(){return"xml"===this._subtype&&("text"===this._type||"application"===this._type)||this._subtype.endsWith("+xml")}isHTML(){return"html"===this._subtype&&"text"===this._type}}(o);if(i&&"multipart"===i.type&&"mixed"===i.subtype){const t=function(e,t){return new B((n=>{if(null===e.body)throw new Error("Missing body");if("function"!=typeof e.body.tee)throw new Error("Streaming bodies not supported by provided fetch implementation");const r=new TextDecoder("utf-8");let o="";const i=`--${t.parameters.get("boundary")||"-"}`,s=e.body.getReader();!function e(){s.read().then((t=>{var s,a,c;if(t.done)return void(null===(s=n.complete)||void 0===s||s.call(n));const l=r.decode(t.value);o+=l;let u=o.indexOf(i);for(;u>-1;){const e=o.slice(0,u);if(o=o.slice(u+i.length),e.trim()){const t=e.indexOf("\r\n\r\n"),r=Object.fromEntries(e.slice(0,t).split("\n").map((e=>{const t=e.indexOf(":");return t>-1?[e.slice(0,t).trim(),e.slice(t+1).trim()]:null})).filter((e=>!!e)));if(-1===(null===(a=r["content-type"])||void 0===a?void 0:a.toLowerCase().indexOf("application/json")))throw new Error("Unsupported patch content type");const o=e.slice(t);try{null===(c=n.next)||void 0===c||c.call(n,{data:JSON.parse(o),headers:r,size:l.length})}catch(e){throw e}}u=o.indexOf(i)}e()})).catch((e=>{var t,r;"AbortError"!==e.name&&(e.result&&e.result.errors&&e.result.data&&(null===(t=n.next)||void 0===t||t.call(n,{data:e.result,size:Infinity})),null===(r=n.error)||void 0===r||r.call(n,e))}))}()}))}(e,i);let o=!0;t.subscribe({next(t){H({message:{name:r,operationId:c,response:{incremental:t.data.incremental,data:t.data.data,errors:t.data.errors,extensions:t.data.extensions,path:t.data.path,status:e.status,headers:o?[n,...t.headers?[t.headers]:[]]:t.headers,hasNext:!0,size:t.size}},embeddedIFrameElement:a,embedUrl:l}),o=!1},error(e){H({message:{name:r,operationId:c,response:{data:null,error:Object.assign({message:e.message},e.stack?{stack:e.stack}:{}),size:0,hasNext:!1}},embeddedIFrameElement:a,embedUrl:l})},complete(){H({message:{name:r,operationId:c,response:{data:null,size:0,status:e.status,headers:o?n:void 0,hasNext:!1}},embeddedIFrameElement:a,embedUrl:l})}})}else{const t=yield e.json();H({message:{name:r,operationId:c,response:Object.assign(Object.assign({},t),{status:e.status,headers:n,hasNext:!1})},embeddedIFrameElement:a,embedUrl:l})}},new((n=void 0)||(n=Promise))((function(e,r){function i(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,s)}a((o=o.apply(t,[])).next())}));var t,n,o})).catch((e=>{H({message:{name:r,operationId:c,response:{error:Object.assign({message:e.message},e.stack?{stack:e.stack}:{}),hasNext:!1}},embeddedIFrameElement:a,embedUrl:l})}))}({endpointUrl:null!=_?_:S,handleRequest:i,operation:t,operationName:u,variables:p,headers:d,embeddedIFrameElement:s,operationId:n,embedUrl:c}):l&&function({operation:e,operationName:t,variables:n,headers:r,embeddedIFrameElement:i,operationId:s,embedUrl:a,subscriptionUrl:c,protocol:l}){const u=new et(c,null!=r?r:{},l),p=e=>{"ExplorerSubscriptionTermination"===e.data.name&&(u.unsubscribeAll(),window.removeEventListener("message",p))};window.addEventListener("message",p),u.onError((e=>tt({error:JSON.parse(JSON.stringify(e)),embeddedIFrameElement:i,embedUrl:a}))),u.onConnected((()=>{tt({error:void 0,embeddedIFrameElement:i,embedUrl:a}),nt({status:"connected",embeddedIFrameElement:i,embedUrl:a})})),u.onReconnected((()=>{tt({error:void 0,embeddedIFrameElement:i,embedUrl:a}),nt({status:"connected",embeddedIFrameElement:i,embedUrl:a})})),u.onConnecting((()=>nt({status:"connecting",embeddedIFrameElement:i,embedUrl:a}))),u.onReconnecting((()=>nt({status:"connecting",embeddedIFrameElement:i,embedUrl:a}))),u.onDisconnected((()=>nt({status:"disconnected",embeddedIFrameElement:i,embedUrl:a}))),u.request({query:e,variables:null!=n?n:{},operationName:t}).subscribe({next(e){H({message:{name:o,operationId:s,response:{data:e}},embeddedIFrameElement:i,embedUrl:a})},error:e=>{H({message:{name:o,operationId:s,response:{error:JSON.parse(JSON.stringify(e))}},embeddedIFrameElement:i,embedUrl:a})}})}({operation:t,operationName:u,variables:p,headers:d,embeddedIFrameElement:s,operationId:n,embedUrl:c,subscriptionUrl:a.subscriptionUrl,protocol:a.protocol})}}};return window.addEventListener("message",l),{dispose:()=>window.removeEventListener("message",l)}}({embeddedSandboxIFrameElement:this.embeddedSandboxIFrameElement,handleRequest:this.handleRequest,__testLocal__:!!this.__testLocal__})}dispose(){var e;null===(e=document.getElementById(i(this.uniqueEmbedInstanceId)))||void 0===e||e.remove(),this.disposable.dispose()}injectEmbed(){var t,n;let r;const{target:o}=this.options,{document:s,variables:a,headers:c}=this.options.initialState||{},l={endpoint:this.options.initialEndpoint,defaultDocument:s?encodeURIComponent(s):void 0,defaultVariables:a?encodeURIComponent(JSON.stringify(a,null,2)):void 0,defaultHeaders:c?encodeURIComponent(JSON.stringify(c)):void 0,parentSupportsSubscriptions:!0,version:"1.0.1",runTelemetry:!0,initialRequestQueryPlan:null!==(t=this.options.initialRequestQueryPlan)&&void 0!==t&&t},u=Object.entries(l).filter((([e,t])=>void 0!==t)).map((([e,t])=>`${e}=${t}`)).join("&");r="string"==typeof o?null===(n=null===document||void 0===document?void 0:document.querySelector)||void 0===n?void 0:n.call(document,o):o;const p=document.createElement("iframe");return p.src=`${e(this.__testLocal__)}?${u}`,p.id=i(this.uniqueEmbedInstanceId),p.setAttribute("style","height: 100%; width: 100%; border: none;"),null==r||r.appendChild(p),fetch(`${window.location.origin}/favicon.ico`).then((e=>{if(404===e.status&&!document.querySelector('link[rel*="icon"]')){var t=window.matchMedia("(prefers-color-scheme: dark)").matches;["icon","apple-touch-icon"].forEach((e=>{var n=document.createElement("link");n.rel=e,n.href=`https://embeddable-explorer.cdn.apollographql.com/_latest/public/assets/favicon${t?"-dark":""}.png`,document.head.appendChild(n)}))}})).catch((()=>{})),p}validateOptions(){if(!this.options.target)throw new Error('"target" is required')}updateSchemaInEmbed({schema:t}){H({message:{name:n,schema:t},embeddedIFrameElement:this.embeddedSandboxIFrameElement,embedUrl:e(this.__testLocal__)})}}}));
//# sourceMappingURL=embeddable-sandbox.umd.production.min.js.map
