{
  "query": "{\n  vms(\n    where: {\n      securityGroups_SOME: {\n        rules_SOME: {\n          direction: \"Inbound\"\n          action: \"Allow\"\n          AND: [\n            {\n              OR: [\n                { sources_INCLUDES: \"cidr:0.0.0.0/0\" }\n                { sources_INCLUDES: \"cidr:::/0\" }\n              ]\n            }\n            { sourceFromPort_LTE: 22, sourceToPort_GTE: 22 }\n          ]\n        }\n      }\n      iamRoles_SOME: {\n        iamPolicies_SOME: { \n          iamPolicyStatements_SOME: { \n            AND: [\n              { effect: \"Allow\" }\n              {\n                permissions_SOME: {\n                  isOwnedByIAMAssetType_SOME: {\n                    includesKMSKey_ALL: {\n                      dataStores_NOT: null\n                    }\n                  }\n                }\n              }\n            ]\n          } \n        }\n      }\n    }\n  ) {\n    iamRoles {\n      iamPolicies {\n        iamPolicyStatements {\n          permissions {\n            isOwnedByIAMAssetType {\n              includesKMSKey {\n                ...AssetFragment\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}",
  "name": "Used AWS KMSKeys Exposed Through Vulnerable VMs",
  "slug": "used-aws-keys-exposed-through-vms"
}