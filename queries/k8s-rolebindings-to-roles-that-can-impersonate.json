{
  "name": "Kubernetes RoleBindings to Roles which provide impersonate privileges",
  "slug": "k8s-rolebindings-to-roles-that-can-impersonate",
  "query": "{\n  roles(\n    where: {\n      AND: [\n        {\n          rules_SOME: {\n            AND: [\n              {\n                OR: [\n                  { verbs_INCLUDES: \"impersonate\" }\n                  { verbs_INCLUDES: \"*\" }\n                ]\n              }\n              {\n                OR: [\n                  { resources_INCLUDES: \"users\" }\n                  { resources_INCLUDES: \"serviceaccounts\" }\n                  { resources_INCLUDES: \"groups\" }\n                  { resources_INCLUDES: \"uids\" }\n                  { resources_INCLUDES: \"*\" }\n                ]\n              }\n              { OR: [{ apiGroup_INCLUDES: \"\" }, { apiGroup_INCLUDES: \"*\" }] }\n            ]\n          }\n        },\n        {bindings_SOME: {idFromProvider_NOT: \"\"}}\n      ]\n    }\n  ) {\n    bindings {\n      ...AssetFragment\n    }\n  }\n}\n"
}