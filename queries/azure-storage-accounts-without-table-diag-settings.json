{
  "name": "Storage Accounts without Table Diagnostic Settings",
  "slug": "azure-storage-accounts-without-table-diag-settings",
  "query": "{\n  storageAccounts(\n    where: {\n      OR: [\n        { isTableServicesDiagnosticsSettingsEnabled: false }\n        {\n          AND: [\n            {\n              diagnosticSettings_NONE: {\n                resourceType: \"Microsoft.Storage/storageAccounts/tableServices\"\n                AND: [\n                  { logs_SINGLE: { enabled: true, category: \"StorageRead\" } }\n                  { logs_SINGLE: { enabled: true, category: \"StorageWrite\" } }\n                  { logs_SINGLE: { enabled: true, category: \"StorageDelete\" } }\n                ]\n              }\n            }\n            {\n              diagnosticSettings_NONE: {\n                resourceType: \"Microsoft.Storage/storageAccounts/tableServices\"\n                logs_SOME: {\n                  enabled: true\n                  categoryGroup_IN: [\"audit\", \"allLogs\"]\n                }\n              }\n            }\n          ]\n        }\n      ]\n    }\n  ) {\n    ...AssetFragment\n  }\n}"
}
