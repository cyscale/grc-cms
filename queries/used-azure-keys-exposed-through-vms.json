{
  "query": "{ vms( where: { \n  iamRoles_SOME: {\n      hasIAMPermissions_SOME: {\n        isOwnedByIAMAssetType_SOME: {\n          includesKMSKey_SOME: {\n            dataStores_NOT: null\n          }\n        }\n      }\n    } \n    networkInterfaces_SOME: { securityGroups_SOME: { rules_SOME: { direction: \"Inbound\" action: \"Allow\" AND: [ { OR: [ { sources_INCLUDES: \"cidr:0.0.0.0/0\" } { sources_INCLUDES: \"cidr:::/0\" } { sources_INCLUDES: \"tag:Internet\" } { sources: [] } ] } { sourceFromPort_LTE: 22, sourceToPort_GTE: 22 } ] } } } } ) { vmRoles { hasIAMPermissions { isOwnedByIAMAssetType { includesKMSKey {identifier} } } } } }",
  "slug": "used-azure-keys-exposed-through-vms",
  "name": "Used Azure KMSKeys Exposed Through Vulnerable VMs"
}