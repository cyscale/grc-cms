{
  "query": "{\n  vms(\n    where: {\n      iamRoles_SOME: {\n        hasIAMPermissions_SOME: {\n          isOwnedByIAMAssetType_SOME: {\n            includesKMSKey_SOME: { dataStores_NOT: null }\n          }\n        }\n      }\n      networkInterfaces_SOME: {\n        securityGroups_SOME: {\n          rules_SOME: {\n            direction: \"Inbound\"\n            action: \"Allow\"\n            AND: [\n              {\n                OR: [\n                  { sources_INCLUDES: \"cidr:0.0.0.0/0\" }\n                  { sources_INCLUDES: \"cidr:::/0\" }\n                  { sources_INCLUDES: \"tag:Internet\" }\n                  { sources: [] }\n                ]\n              }\n              { sourceFromPort_LTE: 22, sourceToPort_GTE: 22 }\n            ]\n          }\n        }\n      }\n    }\n  ) {\n    vmRoles {\n      hasIAMPermissions {\n        isOwnedByIAMAssetType {\n          includesKMSKey {\n            ...AssetFragment\n          }\n        }\n      }\n    }\n  }\n}\n",
  "slug": "used-azure-keys-exposed-through-vms",
  "name": "Used Azure KMSKeys Exposed Through Vulnerable VMs"
}