{
  "name": "Azure storage accounts without queue service diagnostic settings logging",
  "query": "{\n  storageAccounts(\n    where: {\n      OR: [\n        { isQueueServicesDiagnosticsSettingsEnabled: false }\n        {\n          AND: [\n            {\n              diagnosticSettings_NONE: {\n                resourceType: \"Microsoft.Storage/storageAccounts/queueServices\"\n                AND: [\n                  { logs_SINGLE: { enabled: true, category: \"StorageRead\" } }\n                  { logs_SINGLE: { enabled: true, category: \"StorageWrite\" } }\n                  { logs_SINGLE: { enabled: true, category: \"StorageDelete\" } }\n                ]\n              }\n            }\n            {\n              diagnosticSettings_NONE: {\n                resourceType: \"Microsoft.Storage/storageAccounts/queueServices\"\n                logs_SOME: {\n                  enabled: true\n                  categoryGroup_IN: [\"audit\", \"allLogs\"]\n                }\n              }\n            }\n          ]\n        }\n      ]\n    }\n  ) {\n    ...AssetFragment\n  }\n}",
  "slug": "azure-storage-accounts-without-queue-logging"
}
