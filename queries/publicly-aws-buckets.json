{
  "name": "Publicly Accessible AWS Buckets",
  "slug": "publicly-aws-buckets",
  "query": "{\n  buckets(\n    where: {\n      publicAccessBlocked: false\n      OR: [\n        {\n          hasBucketACLGrant_SOME: {\n            OR: [\n              { granteeURI: \"http://acs.amazonaws.com/groups/global/AllUsers\" }\n              {\n                granteeURI: \"http://acs.amazonaws.com/groups/global/AuthenticatedUsers\"\n              }\n            ]\n            permission_IN: [\"READ\", \"WRITE\", \"WRITE_ACP\", \"FULL_CONTROL\"]\n          }\n        }\n        {\n          bucketPolicy: {\n            statements_SOME: {\n              effect: \"Allow\"\n              OR: [\n                { actions_INCLUDES: \"s3:GetObject\" }\n                { actions_INCLUDES: \"s3:ListObjects\" }\n                { actions_INCLUDES: \"s3:ListObjectsV2\" }\n                { actions_INCLUDES: \"s3:PutObject\" }\n                { actions_INCLUDES: \"s3:PutObjectAcl\" }\n                { actions_INCLUDES: \"s3:CreateMultipartUpload\" }\n                { actions_INCLUDES: \"s3:UploadPart\" }\n                { actions_INCLUDES: \"s3:DeleteObject\" }\n                { actions_INCLUDES: \"s3:DeleteObjects\" }\n                { actions_INCLUDES: \"s3:*\" }\n                { actions_INCLUDES: \"*\" }\n              ]\n              principals_INCLUDES: \"AWS|*\"\n            }\n          }\n        }\n      ]\n    }\n  ) {\n    identifier\n    accountID\n    cloudAccountID\n    cloudAccountName\n    cloudProvider\n    idFromProvider\n    internalAssetType\n    internalName\n    internalRegion\n    assetCategory\n    contentHash\n  }\n}\n"
}