{
  "name": "Kubernetes RoleBindings to ClusterRoles that have access to secrets",
  "query": "{\n  clusterRoles(\n    where: {\n      AND: [\n        {\n          rules_SOME: {\n            AND: [\n              {\n                OR: [\n                  { verbs_INCLUDES: \"get\" }\n                  { verbs_INCLUDES: \"list\" }\n                  { verbs_INCLUDES: \"watch\" }\n                  { verbs_INCLUDES: \"*\" }\n                ]\n              }\n              {\n                OR: [\n                  { resources_INCLUDES: \"secrets\" }\n                  { resources_INCLUDES: \"*\" }\n                ]\n              }\n              { OR: [{ apiGroup_INCLUDES: \"\" }, { apiGroup_INCLUDES: \"*\" }] }\n            ]\n          }\n        },\n        {clusterRoleBindings_SOME: {idFromProvider_NOT: \"\"}}\n      ]\n    }\n  ) {\n    clusterRoleBindings {\n      ...AssetFragment\n    }\n  }\n}\n",
  "slug": "k8s-clusterrolebindings-to-clusterroles-that-have-access-to-secrets"
}